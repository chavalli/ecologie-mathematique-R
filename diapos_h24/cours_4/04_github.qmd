---
title: "Science ouverte et reproductibilitÃ©"
author:
  - name: "Charles Frenette-ValliÃ¨res"
date: "2024-02-05"
format: 
  revealjs:
    theme: simple
    highlight: kate
    transition: slide
    center: true
    css: custom.css
    logo: images/ul.png
    scrollable: true
echo: true
---

# La science ouverte

## La science ouverte

Vous Ãªtes-vous dÃ©jÃ  retrouvÃ© devant une image de ce genre?

![](images/purchase-pdf.png){fig-align="center"}

## La science ouverte

Puis, lorsque vous accÃ©dez finalement Ã  l'article et parcourez la section MÃ©thodologie, vous dÃ©couvrez avec joie que les donnÃ©es originales sont disponibles...

![](images/data-access.png){fig-align="center" width="10%"}

## La science ouverte

Pour finalement vous rendre compte que le lien ne fonctionne pas et que mÃªme en fouillant dans la base de donnÃ©es du site vous n'arrivez pas Ã  trouver les dites donnÃ©es.

![](images/data-access-site.png){fig-align="center"}

## La science ouverte

-   MÃ©thodologie ouverte ([Protocol Exchange](https://protocolexchange.researchsquare.com/))
-   DonnÃ©es ouvertes
-   Code source ouvert
-   RÃ©vision ouverte
-   AccÃ¨s ouvert ([Sci-Hub](https://fr.wikipedia.org/wiki/Sci-Hub))

## La science ouverte

Un exemple de science ouverte :

-   AccÃ¨s aux donnÃ©es brutes
-   AccÃ¨s au code source
-   AccÃ¨s gratuit Ã  l'article

![[Jeanne et al., 2019](https://github.com/essicolo/2019_soil-bacterial-microbiome-potato)](images/exemple-code-ouvert.png){fig-align="center"}

## Plan

1.  Un code reproductible
2.  Programmation littÃ©raire avec les formats Markdown
3.  Archivage et suivi de version avec *Git*
4.  Environnement de travail reproductible avec *renv*
5.  Exemples reproductibles, le *reprex*
6.  Fermeture

## Objectifs spÃ©cifiques

Ã€ la fin de ce chapitre, vous

-   saurez exprimer l'importance et les enjeux de la science ouverte
-   saurez arranger vos donnÃ©es (format csv) et votre code (format notebook) afin de rendre vos recherches reproductibles
-   saurez comment crÃ©er un dÃ©pÃ´t sur GitHub, puis administrer son dÃ©veloppement

# 1. Un code reproductible

## Un code reproductible

::: columns
::: {.column width="75%"}
1.   Commencez votre analyse Ã  partir d'une copie des donnÃ©es brutes, dans un format ouvert (csv, json, sqlite, etc.). 
1.    Toute opÃ©ration sur les donnÃ©es devrait Ãªtre effectuÃ©e avec du code, non pas manuellement. 
1.    SÃ©parez vos opÃ©rations en unitÃ©s logiques thÃ©matiques. Par exemple (i) charger, fusionner et nettoyer les donnÃ©es, (ii) analyser les donnÃ©es, (iii) crÃ©er des fichiers comme des tableaux et des figures.
:::

::: {.column width="25%"}
[![](images/bes_frontpage.png)](https://www.britishecologicalsociety.org/wp-content/uploads/2017/12/guide-to-reproducible-code.pdf)
:::
:::

## Un code reproductible

::: columns
::: {.column width="75%"}
4.   Ã‰liminez la duplication du code en crÃ©ant des fonctions personnalisÃ©es.
1.   Documentez votre code et vos donnÃ©es Ã  mÃªme les feuilles de calcul ou dans un fichier de documentation sÃ©parÃ©.
1.   Tout fichier intermÃ©diaire devrait Ãªtre sÃ©parÃ© de vos donnÃ©es brutes.
:::

::: {.column width="25%"}
[![](images/bes_frontpage.png)](https://www.britishecologicalsociety.org/wp-content/uploads/2017/12/guide-to-reproducible-code.pdf)
:::
:::

## La structure d'un projet

Un projet de calcul devrait Ãªtre contenu en un seul dossier.

``` 

ğŸ“ 2019_abeille-canneberge
```

- Note : Le nom du dossier ne contient ni espaces, ni caractÃ¨res spÃ©ciaux.
- Pour bien classer et retrouver mes projets, j'utilise d'abord, puis un titre descriptif du projet.

## La structure d'un projet

::: columns
::: {.column width="60%"}
Dans le dossier principal du projet, on devrait retrouver des dossiers contenant les diffÃ©rents Ã©lÃ©ments du projet.
:::

::: {.column width="40%"}
```         

ğŸ“‚ 2019_abeille-canneberge
|-ğŸ“ documentation
|-ğŸ“ manuscrit
|-ğŸ“ photos
|-ğŸ“ rstats
|-ğŸ“ source
```
:::
:::

## La structure d'un projet

::: columns
::: {.column width="60%"}
Le dossier `ğŸ“‚ rstats` contient le code, les donnÃ©es et les sorties de votre projet. Remarquez la notation des fichiers de script `ğŸ“„ 01_nom.R`. En thÃ©orie, vous devriez pouvoir compresser (*zip*) votre dossier et le partager.
:::

::: {.column width="40%"}
```         

ğŸ“‚ rstats
|-ğŸ“ data
|-ğŸ“ images
|-ğŸ“ lib
|-ğŸ“ tables
ğŸ“„ bees.Rproj
ğŸ“„ 01_clean-data.R
ğŸ“„ 02_data-mining.R
ğŸ“„ 03_data-analysis.R
ğŸ“„ 04_data-modeling.R
ğŸ“„ README.md
```
:::
:::

## Chemin d'accÃ¨s

Important : Dans votre code, tous les chemins d'accÃ¨s devraient Ãªtre **relatifs** au projet, plutÃ´t que le nom complet de votre ordinateur.

```{r}
#| results: false
library(tidyverse)
read_csv("data/heather.csv")
read_csv("~/Documents/github/ecologie-mathematique-R/diapos_h24/cours_4/data/heather.csv")
```


# 2. Programmation littÃ©raire avec les formats Markdown

## Commenter le code

Un code reproductible est un code bien dÃ©crit. Vous pouvez commenter votre code Ã  mÃªme votre fichier de script `.R` pour expliquer les Ã©tapes principales. Cela fonctionne bien pour les plus petits projets.

```         
#############
## Titre 1 ##
#############

# Titre 2
## Titre 3
data <- read_csv("data/abeilles.csv") # commentaire particulier
```

## Les formats Markdown

Pour les plus gros projets, le format [markdown](https://daringfireball.net/projects/markdown/) devient trÃ¨s utile. Les principaux outils sont R Markdown et Quarto, mais les deux utilisent principalement les mÃªmes balises.

::: columns
::: {.column width="50%"}

[![](https://github.com/rstudio/rmarkdown/raw/main/man/figures/logo.png)](https://rmarkdown.rstudio.com/)

:::

::: {.column width="50%"}

[![](https://quarto.org/quarto.png)](https://quarto.org/)

:::
:::

## Balises markdown principales

**Italique**. AstÃ©risques simples `*`. Par exemple, "`Texte en *italique*`" devient "Texte en *italique*"

**Gras**. Doubles astÃ©risques `**`. Par exemple, "`Texte en **gras**`" devient "Texte en **gras**".

**Largeur fixe**. Accents graves. Par exemple, "`` Texte de `code` ``" devient "Texte de `code`"

## Balises markdown principales

**Listes**. 

::: columns
::: {.column width="50%"}
Pour effectuer une liste numÃ©rotÃ©e, utilisez le chiffre `1.`

```         
1. Paul
1. Leto
1. Alia
```
devient

1.  Paul
2.  Leto
3.  Alia
:::

::: {.column width="50%"}
De mÃªme, pour une liste Ã  puces, changez le `1.` par le `-` ou le `*`.

```         
- Paul
- Leto
- Alia
```
devient

- Paul
- Leto
- Alia
:::
:::

## Balises markdown principales

**EntÃªtes**. Les titres sont prÃ©cÃ©dÃ©s par des `#`. Un `#` pour un titre 1, deux `##` pour un titre 2, etc. Par exemple,

```         

# Titre 1
## Titre 2
### Titre 3
### Titre 3
## Titre 2
# Titre 1
```

InsÃ©rera les titres appropriÃ©s (que je n'insÃ¨re pas pour ne pas bousiller la structure de ce texte).

## Balises markdown principales

**Liens**. Pour insÃ©rer des liens, le texte est entre crochets directement suivi du lien entre parenthÃ¨ses. Par exemple, "`Visitez le site des [notes de cours](https://chavalli.github.io/ecologie-mathematique-R/)`" devient "Visitez le site des [notes de cours](https://chavalli.github.io/ecologie-mathematique-R/)".

**Ã‰quations**. Les Ã©quations suivent la syntaxe Latex entre deux `$$`. Par exemple, `$c = \sqrt{a^2 + b^2}$` devient $c = \sqrt{a^2 + b^2}$.

**Images**. Pour insÃ©rer une image, `![nom de l'image](images/image.png)`.

## R Markdown

[notes de cours](https://chavalli.github.io/ecologie-mathematique-R/05-github.html#r-markdown) ->

## Quarto markdown

![Dessin de la prÃ©sentation [*Hello, Quarto*](https://mine.quarto.pub/hello-quarto/#/hello-quarto-title) par [Julia Lowndes](https://jules32.github.io/) et [Mine Ã‡etinkaya-Rundel](https://mine-cr.com/), prÃ©sentÃ©e Ã  la confÃ©rence RStudio de 2022. IllustrÃ©s par [@Allison Horst](https://twitter.com/allison_horst).](https://github.com/allisonhorst/stats-illustrations/blob/main/julie-mine-quarto-keynote/quarto_schematic.png?raw=true)

## Quarto markdown

![Dessin de la prÃ©sentation [*Hello, Quarto*](https://mine.quarto.pub/hello-quarto/#/hello-quarto-title) par [Julia Lowndes](https://jules32.github.io/) et [Mine Ã‡etinkaya-Rundel](https://mine-cr.com/), prÃ©sentÃ©e Ã  la confÃ©rence RStudio de 2022. IllustrÃ©s par [@Allison Horst](https://twitter.com/allison_horst).](https://github.com/allisonhorst/stats-illustrations/blob/main/julie-mine-quarto-keynote/qmd_render_schema.png?raw=true)

## Quarto markdown

[notes de cours](https://chavalli.github.io/ecologie-mathematique-R/05-github.html#quarto-markdown) ->

# 3. Archivage et suivi de version avec *Git*

## Archivage et suivi de version avec *Git*

Git vous permet de publier efficacement vos donnÃ©es, votre code et votre documentation en un seul endroit.

[notes de cours](https://chavalli.github.io/ecologie-mathematique-R/05-github.html#sec-intro-git) ->

# 4. Environnement de travail reproductible avec *renv*

## Environnement de travail reproductible avec *renv*

*renv* vous permet de garder la trace des versions de votre logiciel et de vos modules au moment oÃ¹ votre code a Ã©tÃ© dÃ©veloppÃ©, comme une image.

[notes de cours](https://chavalli.github.io/ecologie-mathematique-R/05-github.html#sec-git-renv) ->

# 5. Exemples reproductibles, le *reprex*

## Exemples reproductibles, le *reprex*



# 6. Pour terminer

## Retour sur les objectifs

Ã€ la fin de ce chapitre, vous

-   saurez exprimer l'importance et les enjeux de la science ouverte
-   saurez arranger vos donnÃ©es (format csv) et votre code (format notebook) afin de rendre vos recherches reproductibles
-   saurez comment crÃ©er un dÃ©pÃ´t sur GitHub, puis administrer son dÃ©veloppement

## Pour terminer

Assurez-vous d'avoir un code reproductible en structurant adÃ©quatement vos projets et votre code.
Explorez les outils markdown.
Explorez les rÃ©pertoires github, et essayer de crÃ©er votre propre rÃ©pertoire!

Lectures :

-   [Chapitre 5 des notes de cours](https://chavalli.github.io/ecologie-mathematique-R/05-github.html)
