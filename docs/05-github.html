<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Analyse et modÃ©lisation dâ€™agroÃ©cosystÃ¨mes sur R - 5&nbsp; Science ouverte et reproductibilitÃ©</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-python.html" rel="next">
<link href="./04-visualisation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-github.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Science ouverte et reproductibilitÃ©</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analyse et modÃ©lisation dâ€™agroÃ©cosystÃ¨mes sur R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/chavalli/ecologie-mathematique-R/tree/h2024" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PrÃ©face</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">La science des donnÃ©es avec R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-tableaux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Organisation des donnÃ©es et opÃ©rations sur des tableaux</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Visualisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-github.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Science ouverte et reproductibilitÃ©</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction Ã  Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07a-biostats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Biostatistiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07b-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction Ã  lâ€™analyse bayÃ©sienne en Ã©cologie</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-explorer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Explorer R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Association, partitionnement et ordination</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-imputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">DÃ©tection de valeurs aberrantes et imputation de donnÃ©es manquantes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-series-temporelles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Les sÃ©ries temporelles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-autoapprentissage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction Ã  lâ€™autoapprentissage</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-donnees-spatiales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Les donnÃ©es gÃ©ospatiales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-modelisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">ModÃ©lisation de mÃ©canismes Ã©cologiques</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#un-code-reproductible" id="toc-un-code-reproductible" class="nav-link active" data-scroll-target="#un-code-reproductible"><span class="header-section-number">5.1</span> Un code reproductible</a>
  <ul class="collapse">
<li><a href="#structure-dun-projet" id="toc-structure-dun-projet" class="nav-link" data-scroll-target="#structure-dun-projet"><span class="header-section-number">5.1.1</span> Structure dâ€™un projet</a></li>
  <li><a href="#les-formats-markdown" id="toc-les-formats-markdown" class="nav-link" data-scroll-target="#les-formats-markdown"><span class="header-section-number">5.1.2</span> Les formats markdown</a></li>
  <li><a href="#quarto-markdown" id="toc-quarto-markdown" class="nav-link" data-scroll-target="#quarto-markdown"><span class="header-section-number">5.1.3</span> Quarto markdown</a></li>
  </ul>
</li>
  <li><a href="#sec-intro-git" id="toc-sec-intro-git" class="nav-link" data-scroll-target="#sec-intro-git"><span class="header-section-number">5.2</span> Introduction Ã  GitHub</a></li>
  <li><a href="#sec-git-renv" id="toc-sec-git-renv" class="nav-link" data-scroll-target="#sec-git-renv"><span class="header-section-number">5.3</span> Introduction Ã  <strong><code>renv</code></strong></a></li>
  <li><a href="#pour-terminer-le-reprex" id="toc-pour-terminer-le-reprex" class="nav-link" data-scroll-target="#pour-terminer-le-reprex"><span class="header-section-number">5.4</span> Pour terminer, le <strong>reprex</strong></a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-git" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Science ouverte et reproductibilitÃ©</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><hr>
<p><strong>Objectifs spÃ©cifiques</strong> :</p>
<p>Ã€ la fin de ce chapitre, vous</p>
<ul>
<li>saurez exprimer lâ€™importance et les enjeux de la science ouverte</li>
<li>saurez arranger vos donnÃ©es (format csv) et votre code (format notebook) afin de rendre vos recherches reproductibles</li>
<li>saurez comment crÃ©er un dÃ©pÃ´t sur GitHub, puis administrer son dÃ©veloppement</li>
</ul>
<hr>
<p>La science ouverte favorise la diffusion des connaissances Ã  travers plusieurs aspects.</p>
<ul>
<li>
<strong>MÃ©thodologie ouverte</strong>. Ce nâ€™est pas pour rien que les revues scientifiques demandent de la minutie dans la description de la mÃ©thodologie: câ€™est pour sâ€™assurer de bien comprendre la signification des donnÃ©es collectÃ©es et faire en sorte que vos donnÃ©es puissent Ãªtre Ã©chantillonnÃ©es de la mÃªme maniÃ¨re dans une potentielle expÃ©rience subsÃ©quente. Ã€ ce titre, la revue <em>Nature</em> a crÃ©Ã© le site de publication de protocoles expÃ©rimentaux <a href="https://www.nature.com/protocolexchange/">Protocol exchange</a>, â€œoÃ¹ la communautÃ© scientifique met en commun son savoir-faire expÃ©rimental pour accÃ©lÃ©rer la rechercheâ€ (ma traduction).</li>
<li>
<strong>DonnÃ©es ouvertes</strong>. En rendant nos donnÃ©es publiques, on permet Ã  la postÃ©ritÃ© de les utiliser pour amÃ©liorer les connaissances, dÃ©couvrir des structures qui nous avaient Ã©chappÃ©, etc. Dans certains cas, lâ€™ouverture des donnÃ©es peut Ãªtre contrainte par des enjeux lÃ©gaux (donnÃ©es privÃ©es) ou Ã©thiques (donnÃ©es pouvant Ãªtre utilisÃ©es Ã  mauvais escient). Dans la plupart des cas, les avantages surpassent largement les risques encourus par la publication des donnÃ©es, et les informations personnelles peuvent Ãªtre retirÃ©es. Des journaux comme Plos <a href="https://blogs.plos.org/everyone/2014/02/24/plos-new-data-policy-public-access-data-2/">exigent</a> que les donnÃ©es minimales Ã  la reproduction de lâ€™expÃ©rience soient fournies en tant que matÃ©riel supplÃ©mentaire.</li>
<li>
<strong>Code source ouvert</strong>. Les logiciels <em>open source</em>, comme R, sont gratuits pour la plupart. Cela permet Ã  quiconque de les utiliser, pourvu que lâ€™on possÃ¨de le support matÃ©riel (un ordinateur) et une connection internet. De la mÃªme maniÃ¨re, le code R qui vous a permis de gÃ©nÃ©rer des rÃ©sultats Ã  partir de vos donnÃ©es peut Ãªtre rendu public sous toutes sortes de licenses <em>open source</em> peu restrictive (GPL, BSD, MIT, etc.). Avec les donnÃ©es et le code, vos travaux pourront Ãªtre reproduits.</li>
<li>
<strong>RÃ©vision ouverte</strong>. La rÃ©vision est un travail essentiel en science. Traditionnellement, les publications scientifiques sont rÃ©visÃ©es de maniÃ¨re anonyme, le but Ã©tant dâ€™Ã©viter les conflits. RÃ©cemment, des revues comme <a href="https://www.frontiersin.org/about/review-system">Frontiers</a> ont dÃ©ployÃ© des modes de rÃ©vision ouverts, permettant (1) des Ã©changes plus constructifs entre auteurs et rÃ©viseurs et (2) de remercier ouvertement la contribution des rÃ©viseurs Ã  lâ€™article final.</li>
<li>
<strong>AccÃ¨s ouvert</strong>. Les Ã©diteurs scientifiques sont <a href="https://www.nature.com/articles/d41586-019-00492-4">largement critiquÃ©s</a> pour demander des frais usuraires aux bibliothÃ¨ques et pour la consultation Ã  la piÃ¨ce, ainsi que des frais de publication dÃ©mesurÃ©s. En rÃ©action Ã  cela, le site <a href="https://fr.wikipedia.org/wiki/Sci-Hub">Sci-Hub</a> dÃ©bloque gratuitement des millions dâ€™articles scientifiques. Aussi, des journaux sÃ©rieux comme Plos et Frontiers publient <em>de facto</em> les articles sur leur site internet, de sorte quâ€™ils peuvent Ãªtre librement tÃ©lÃ©chargÃ©s.</li>
</ul>
<p>Le manque dâ€™ouverture dans la science a menÃ© plusieurs scientifiques Ã  parler dâ€™une crise de la reproductibilitÃ© (<a href="https://www.nature.com/news/1-500-scientists-lift-the-lid-on-reproducibility-1.19970">Baker, 2016</a>). Dans ce chapitre, nous verrons quelques astuces pour que R devienne un outil favorisant la science ouverte. Ã€ la fin de ce chapitre, vous devriez Ãªtre en mesure de dÃ©ployer votre code sur une archive en ligne, comme ceci.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-exemple" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_github_exemple.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.1: Exemple dâ€™un dossier de code et de donnÃ©es ouvertes, (<a href="https://doi.org/10.1371/journal.pone.0214089">Jeanne et al.&nbsp;2019</a>)</figcaption></figure>
</div>
</div>
</div>
<section id="un-code-reproductible" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="un-code-reproductible">
<span class="header-section-number">5.1</span> Un code reproductible</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-repre-bes" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_bes_frontpage.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.2: A Guide to Reproducible Code in Ecology and Evolution, <a href="https://www.britishecologicalsociety.org/wp-content/uploads/2017/12/guide-to-reproducible-code.pdf">BES 2017</a></figcaption></figure>
</div>
</div>
</div>
<p>La <em>British ecological society</em> offre des lignes guide pour crÃ©er un flux de travail reproductible (<a href="https://www.britishecologicalsociety.org/wp-content/uploads/2017/12/guide-to-reproducible-code.pdf">BES, 2017</a>). En outre, les principes suivants doivent Ãªtre respectÃ©s (ma traduction, avec ajouts).</p>
<ul>
<li>Commencez votre analyse Ã  partir dâ€™une copie des donnÃ©es brutes. Les donnÃ©es doivent Ãªtre fournies dans un format ouvert (csv, json, sqlite, etc.). Ã‰vitez de dÃ©marrer une analyse par un chiffrier Ã©lectronique ou un logiciel propriÃ©taire (qui nâ€™est pas <em>open source</em>). En ce sens, dÃ©marrer avec Excel (<code>xls</code> ou <code>xlsx</code>) est Ã  Ã©viter, tout comme le sont les donnÃ©es encodÃ©es pour SPSS ou SAS.</li>
<li>Toute opÃ©ration sur les donnÃ©es, que ce soit du nettoyage, des fusions, des transformations, etc. devrait Ãªtre effectuÃ©e avec du code, non pas manuellement. Sâ€™il sâ€™agit dâ€™une erreur de frappe dans un tableau, on peut dÃ©roger Ã  la rÃ¨gle. Mais sâ€™il sâ€™agit par exemple dâ€™Ã©liminer des outliers, ne supprimez pas des entrÃ©es de vos donnÃ©es brutes. De mÃªme, nâ€™effectuez pas de transformation de vos donnÃ©es brutes Ã  lâ€™extÃ©rieur du code. En somme, vos calculs devraient Ãªtre en mesure dâ€™Ãªtre lancÃ©s dâ€™un seul coup, sans opÃ©rations manuelles intermÃ©diaires.</li>
<li>SÃ©parez vos opÃ©rations en unitÃ©s logiques thÃ©matiques. Par exemple, vous pourriez sÃ©parer votre code en parties: (i) charger, fusionner et nettoyer les donnÃ©es, (ii) analyser les donnÃ©es, (iii) crÃ©er des fichiers comme des tableaux et des figures.</li>
<li>Ã‰liminez la duplication du code en crÃ©ant des fonctions personnalisÃ©es. Assurez-vous de commenter vos fonctions en dÃ©tails, expliquez ce qui est attendu comme entrÃ©es et comme sorties, ce quâ€™elles font et pourquoi.</li>
<li>Documentez votre code et vos donnÃ©es Ã  mÃªme les feuilles de calcul ou dans un fichier de documentation sÃ©parÃ©.</li>
<li>Tout fichier intermÃ©diaire devrait Ãªtre sÃ©parÃ© de vos donnÃ©es brutes.</li>
</ul>
<section id="structure-dun-projet" class="level3" data-number="5.1.1"><h3 data-number="5.1.1" class="anchored" data-anchor-id="structure-dun-projet">
<span class="header-section-number">5.1.1</span> Structure dâ€™un projet</h3>
<p>Un projet de calcul devrait Ãªtre contenu en un seul dossier. Si vous nâ€™avez que quelques projets, il est assez facile de garder lâ€™info en mÃ©moire. Toutefois, en particulier en milieu dâ€™entreprise, il se pourrait fort bien que vous ayez Ã  mener plusieurs projets de front. Certaines entreprises crÃ©ent des numÃ©ros de projet: vous aurez avantage Ã  nommer vos dossiers avec ces numÃ©ros, incluant une brÃ¨ve description. Pour ma part, jâ€™ordonne mes projets chronologiquement par annÃ©e, avec un descriptif.</p>
<pre><code>ğŸ“ 2019_abeille-canneberge</code></pre>
<p>Notez que je nâ€™utilise ni espace, ni caractÃ¨re spÃ©cial dans le nom du fichier, pour Ã©viter les erreurs potentielles avec des logiciels capricieux.</p>
<p>Ã€ lâ€™intÃ©rieur du dossier racine du projet, jâ€™inclus lâ€™information gÃ©nÃ©rale: donnÃ©es source (souvent des fichiers Excel), manuscrit (mÃ©moire, thÃ¨se, article, etc.) documentation particuliÃ¨re (pour les articles, jâ€™utilise <a href="https://www.zotero.org/">Zotero</a>, un gestionnaire de rÃ©fÃ©rence), photos et, Ã©videmment, mon dossier de code (par exemple <code>rstats</code>).</p>
<pre><code>
ğŸ“‚ 2019_abeille-canneberge
|-ğŸ“ documentation
|-ğŸ“ manuscrit
|-ğŸ“ photos
|-ğŸ“ rstats
|-ğŸ“ source</code></pre>
<p>Si vous rÃ©digez votre manuscrit Ã  mÃªme votre code (en Latex, <a href="https://www.lyx.org/">Lyx</a>, markdown, R markdown ou Quarto que nous verrons plus loin), vous pouvez trÃ¨s bien lâ€™inclure dans votre fichier de calcul.</p>
<p>Ã€ lâ€™intÃ©rieur du fichier de calcul, vous aurez votre projet RStudio et vos feuilles de calcul sÃ©quencÃ©es. Jâ€™utilise <code>01-</code>, et non pas <code>1-</code> pour Ã©viter que le <code>10-</code> suive le <code>1-</code> dans le classement en ordre alpha-numÃ©rique au cas oÃ¹ jâ€™aurais plus de 10 feuilles de calcul. Jâ€™inclus un fichier <code>README.md</code> (extension md pour markdown), qui contient les informations gÃ©nÃ©rales de mes calculs. Les donnÃ©es brutes (<code>csv</code>) sont placÃ©es dans un dossier <code>data</code>, mes graphiques sont exportÃ©s dans un dossier <code>images</code>, mes tableaux sont exportÃ©s dans un dossier <code>tables</code> et mes fonctions externes sont exportÃ©es dans un dossier <code>lib</code>.</p>
<pre><code>
ğŸ“‚ rstats
|-ğŸ“ data
|-ğŸ“ images
|-ğŸ“ lib
|-ğŸ“ tables
ğŸ“„ bees.Rproj
ğŸ“„ 01_clean-data.R
ğŸ“„ 02_data-mining.R
ğŸ“„ 03_data-analysis.R
ğŸ“„ 04_data-modeling.R
ğŸ“„ README.md</code></pre>
<p>Je dÃ©cris les noms de fichiers dans la langue de communication utile pour le rendu final du projet, souvent en anglais lors de publications acadÃ©miques. Jâ€™Ã©vite les noms de fichier qui ne sont pas informatifs, par exemple <code>01.R</code> ou <code>Rplot1.png</code>, ainsi que les majuscules, les caractÃ¨res spÃ©ciaux et les espaces comme dans <code>DeuxiÃ¨me essai.R</code> (le <code>README.md</code> est une exception).</p>
<p>Pour partager un dossier de projet sur R, on nâ€™a quâ€™Ã  le compresser (<em>zip</em>), puis Ã  lâ€™envoyer. Pour que le code fonctionne sur un autre ordinateur, les liens vers les fichiers de donnÃ©es Ã  importer ou les graphiques exportÃ©s doivent Ãªtre relatifs au fichier R ouvert dans votre projet, non pas le chemin complet sur votre ordinateur.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-rel-link-allison-horst" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/here.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.3: Retrouvez votre chemin, dessin de <a href="https://twitter.com/allison_horst"><span class="citation" data-cites="Allison">@Allison</span> Horst</a></figcaption></figure>
</div>
</div>
</div>
<p>Tout comme la BSE, lâ€™organisme sans but lucratif <a href="https://ropensci.org">rOpenSci</a> offre <a href="https://ropensci-archive.github.io/reproducibility-guide/">un guide sur la reproductibilitÃ©</a> (le rÃ©pertoire est maintenant archivÃ© et nâ€™est plus mis Ã  jour depuis 2022, mais vous y avez tout de mÃªme accÃ¨s en lecture seule).</p>
</section><section id="les-formats-markdown" class="level3" data-number="5.1.2"><h3 data-number="5.1.2" class="anchored" data-anchor-id="les-formats-markdown">
<span class="header-section-number">5.1.2</span> Les formats <a href="https://daringfireball.net/projects/markdown/">markdown</a>
</h3>
<p>Un code reproductible est un code bien dÃ©crit. La structure de projet prÃ©sentÃ©e prÃ©cÃ©demment propose de segmenter le code en plusieurs fichiers R. Cette maniÃ¨re de procÃ©der est optionnelle. Si le fichier de calcul nâ€™est pas trop encombrant, on pourra nâ€™en utiliser quâ€™un seul, par exemple <code>stats.R</code>. Ã€ lâ€™intÃ©rieur mÃªme des feuilles de calcul R, vous devrez commenter votre code pour en expliquer les Ã©tapes, par exemple:</p>
<pre><code>#############
## Titre 1 ##
#############

# Titre 2
## Titre 3
data &lt;- read_csv("data/abeilles.csv") # commentaire particulier</code></pre>
<p>RStudio a dÃ©veloppÃ© une approche plus conviviale avec son format <strong>R markdown</strong>. Le langage <a href="https://daringfireball.net/projects/markdown/basics"><em>markdown</em></a> permet de formater un texte avec un minimum de dÃ©corations, et R markdown permet dâ€™intÃ©grer du texte et des codes. Le manuel original de notes de cours Ã©tait par ailleurs entiÃ¨rement Ã©crit en R markdown.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-allison-horst-rmarkdown" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_rmarkdown_wizards.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.4: La magie de <em>R markdown</em>, dessin de <a href="https://twitter.com/allison_horst"><span class="citation" data-cites="Allison">@Allison</span> Horst</a></figcaption></figure>
</div>
</div>
</div>
<p>Depuis quelques annÃ©es, <a href="https://quarto.org/">Quarto</a> a fait son entrÃ©e en scÃ¨ne. Il sâ€™agit de la nouvelle version de R markdown qui se veut plus attrayante, accessible, stable et polyvalente. Quarto a la versatilitÃ© dâ€™utiliser, dans un seul document, des morceaux de code provenant de diffÃ©rents langages, puis de produire des fichiers sous diffÃ©rents formats en une seule Ã©tape. De plus, vous pouvez lâ€™utiliser directement en RStudio ou dans Jupyter. La version actuelle du manuel est montÃ©e Ã  lâ€™aide de Quarto, tout comme les diapositives prÃ©sentÃ©es dans les capsules vidÃ©o du cours.</p>
<div id="fig-git-allison-horst-qmd-render" class="cell quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-git-allison-horst-qmd-render-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="https://github.com/allisonhorst/stats-illustrations/blob/main/julie-mine-quarto-keynote/quarto_schematic.png?raw=true" class="img-fluid figure-img" data-ref-parent="fig-git-allison-horst-qmd-render"></p>
<figcaption class="figure-caption">(a) La versatilitÃ© de Quarto</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-git-allison-horst-qmd-render-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="https://github.com/allisonhorst/stats-illustrations/blob/main/julie-mine-quarto-keynote/qmd_render_schema.png?raw=true" class="img-fluid figure-img" data-ref-parent="fig-git-allison-horst-qmd-render"></p>
<figcaption class="figure-caption">(b) Les Ã©tapes de rendu de Quarto</figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.5: Dessins de la prÃ©sentation <a href="https://mine.quarto.pub/hello-quarto/#/hello-quarto-title"><em>Hello, Quarto</em></a> par <a href="https://jules32.github.io/">Julia Lowndes</a> et <a href="https://mine-cr.com/">Mine Ã‡etinkaya-Rundel</a>, prÃ©sentÃ©e Ã  la confÃ©rence RStudio de 2022. IllustrÃ©s par <a href="https://twitter.com/allison_horst"><span class="citation" data-cites="Allison">@Allison</span> Horst</a>.</figcaption><p></p>
</figure>
</div>
<section id="le-langage-markdown" class="level4" data-number="5.1.2.1"><h4 data-number="5.1.2.1" class="anchored" data-anchor-id="le-langage-markdown">
<span class="header-section-number">5.1.2.1</span> Le langage markdown</h4>
<p>Le langage markdown est ce quâ€™on appelle <a href="https://fr.wikipedia.org/wiki/Markdown">â€œun langage de balises lÃ©gerâ€</a> qui vous permet dâ€™introduire dans votre texte brut des balises simples pour effectuer le formatage. Un fichier portant lâ€™extension <code>.md</code> ou <code>.markdown</code> est un fichier texte clair (que vous pouvez ouvrir et Ã©diter dans votre Ã©diteur texte prÃ©fÃ©rÃ©), tout comme un fichier <code>.R</code>. RStudio permet notamment dâ€™Ã©diter un fichier <code>.md</code>. Il existe aussi de nombreux Ã©diteurs de texte spÃ©cialisÃ©s en Ã©dition markdown - mon prÃ©fÃ©rÃ© est <a href="https://typora.io">Typora</a>. Les dÃ©corations (ou balises) principales en markdown sont les suivantes (les citations utilisÃ©es ci-aprÃ¨s sont tirÃ©es du roman Dune, de Frank Herbert).</p>
<p><strong>Italique</strong>. Pour accentuer en italique, balisez le texte avec des astÃ©risques simples <code>*</code>. Par exemple, â€œ<code>Pourrais-je porter parmi vous le nom de *Paul-Muad'dib*?</code>â€ devient â€œPourrais-je porter parmi vous le nom de <em>Paul-Muadâ€™dib</em>?â€</p>
<p><strong>Gras</strong>. Pour accentuer en gras, balisez le texte avec des doubles astÃ©risques <code>**</code>. Par exemple, â€œ<code>L'espÃ©rance **ternit** l'observation.</code>â€ devient â€œLâ€™espÃ©rance <strong>ternit</strong> lâ€™observationâ€.</p>
<p><strong>Largeur fixe</strong>. Pour un texte Ã  largeur fixe (signifiant du code), balisez le texte avec des accents graves. Par exemple, â€œ<code>Quel nom donnez-vous Ã  la petite `souris`, celle qui saute ?</code>â€ devient â€œQuel nom donnez-vous Ã  la petite <code>souris</code>, celle qui saute?â€</p>
<p><strong>Listes</strong>. Pour effectuer une liste numÃ©rotÃ©e, utilisez le chiffre <code>1.</code> Par exemple,</p>
<pre><code>1. Paul
1. Leto
1. Alia</code></pre>
<p>devient</p>
<ol type="1">
<li>Paul</li>
<li>Jessica</li>
<li>Alia</li>
</ol>
<p>De mÃªme, pour une liste Ã  puces, changez le <code>1.</code> par le <code>-</code> ou le <code>*</code>.</p>
<p><strong>EntÃªtes</strong>. Les titres sont prÃ©cÃ©dÃ©s par des <code>#</code>. Un <code>#</code> pour un titre 1, deux <code>##</code> pour un titre 2, etc. Par exemple,</p>
<pre><code>
# Imperium
## Landsraad
### Maison des AtrÃ©ides
### Maison des Harkonnen
## CHOAM
# Guilde des navigateurs</code></pre>
<p>InsÃ©rera les titres appropriÃ©s (que je nâ€™insÃ¨re pas pour ne pas bousiller la structure de ce texte).</p>
<p><strong>Liens</strong>. Pour insÃ©rer des liens, le texte est entre crochets directement suivi du lien entre parenthÃ¨ses. Par exemple, â€œ<code>Longue vie aux [combattants](https://youtu.be/Cv87NJ2xX0k?t=59)</code>â€ devient â€œLongue vie aux <a href="https://youtu.be/Cv87NJ2xX0k?t=59">combattants</a>â€.</p>
<p><strong>Ã‰quations</strong>. Les Ã©quations suivent la syntaxe Latex entre deux <code>$$</code> pour les Ã©quations sur une ligne et entre des doubles <code>$$ $$</code> pour les Ã©quations sur un paragraphe. Par exemple, <code>$c = \sqrt{a^2 + b^2}$</code> devient <span class="math inline">\(c = \sqrt{a^2 + b^2}\)</span>.</p>
<p><strong>Images</strong>. Pour insÃ©rer une image, <code>![nom de l'image](images/spice-must-flow.png)</code>.</p>
<p>Une liste exhaustive des balises markdown est disponible sous forme dâ€™<a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet">aide-mÃ©moire</a>. Lâ€™extension de RStudio <a href="https://thinkr-open.github.io/remedy/"><strong><code>remedy</code></strong></a>, installable de la mÃªme faÃ§on quâ€™un module, fera apparaÃ®tre une section REMEDY dans le menu Addins, oÃ¹ vous trouverez toutes sortes dâ€™options de formatage automatique (<a href="#fig-git-remedy">Figure&nbsp;<span>5.6</span></a>). Toutefois, vous verrez plus loin dans la section sur Quarto que dâ€™autres outils encore plus conviviaux existent dÃ©sormais.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-remedy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_menu-remedy.png" class="img-fluid figure-img" style="width:40.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.6: Menu des extensions de RStudio, avec lâ€™extension <strong><code>remedy</code></strong></figcaption></figure>
</div>
</div>
</div>
</section><section id="r-markdown" class="level4" data-number="5.1.2.2"><h4 data-number="5.1.2.2" class="anchored" data-anchor-id="r-markdown">
<span class="header-section-number">5.1.2.2</span> R markdown</h4>
<p>Dans RStudio, ouvrez un R markdown par <code>File &gt; New file &gt; R Markdown</code>. Si le module <strong><code>rmarkdown</code></strong> nâ€™est pas installÃ©, RStudio vous demandera de lâ€™installer. Une fenÃªtre apparaÃ®tra.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-rmd-new-file" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_file-new-rmarkdown.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.7: Nouveau fichier R markdown</figcaption></figure>
</div>
</div>
</div>
<p>Les options dâ€™exportation pourront Ãªtre modifiÃ©es par la suite.</p>
<p>Un fichier dâ€™exemple sera crÃ©Ã©, et vous pourrez le modifier. Les parties de texte sont Ã©crits en markdown, et le code R est enchÃ¢ssÃ© entre les balises <code>```{r}</code> et <code>```</code>. Je nommerai ces parties de code des <em>cellules</em> ou des <em>blocs</em> de code. Vous pouvez utiliser le raccourci clavier <code>Ctrl + Alt + I</code> pour insÃ©rer rapidement un bloc de code.</p>
<p>Des options de code peuvent Ãªtre utilisÃ©es Ã  lâ€™intÃ©rieur des accolades <code>{r}</code>. Par exemple</p>
<ul>
<li>
<code>{r, filtre-outliers}</code> donne le nom <code>filtre-outliers</code> au bloc de code, qui permet nommÃ©ment de nommer les images crÃ©Ã©es dans le bloc de code.</li>
<li>
<code>{r, eval = FALSE}</code> permet dâ€™activer (<code>TRUE</code>, valeur par dÃ©faut) ou de dÃ©sactiver (<code>FALSE</code>) le calcul de la cellule.</li>
<li>
<code>{r, echo = FALSE}</code> permet de nâ€™afficher que la sortie de la cellule de code en nâ€™affichant pas le code, par exemple un graphique ou le sommaire dâ€™une rÃ©gression.</li>
<li>
<code>{r, results = FALSE}</code> permet de nâ€™afficher que le code, mais pas la sortie.</li>
<li>
<code>{r, warning = FALSE, message = FALSE, error = FALSE}</code> nâ€™affichera pas les avertissements, les messages automatiques et les messages dâ€™erreur.</li>
<li>
<code>{r, fig.width = 10, fig.height = 5, fig.align = "center"}</code> affichera les graphiques dans les dimensions voulues, alignÃ©e au centre (<code>"center"</code>), Ã  gauche (<code>"left"</code>) ou Ã  droite (<code>"right"</code>).</li>
</ul>
<p>Notez que vous pouvez exÃ©cuter rapidement du code sur une ligne avec la formulation <code>`r `</code>, par exemple <code>la moyenne des nombres `\r a&lt;-round(runif(4, 0, 10)); a` est de `\r mean(a)`</code>, en enlevant les <code>\</code> devant les <code>r</code> (ajoutÃ©es artificiellement pour Ã©viter que le code soit calculÃ©), sera la moyenne des nombres 7, 2, 2, 8 est de 4.75</p>
<p>Une fois que vous serez satisfait de votre document, cliquer sur <code>Knit</code> <img src="images/05_knit-button.png" class="img-fluid"> et le fichier de sortie sera gÃ©nÃ©rÃ©. Le guide qui permet de gÃ©nÃ©rer le fichier de sortie est tout en haut du fichier. Nous lâ€™appelons le YAML (acronyme rÃ©cursif de <em>YAML Ainâ€™t Markup Language</em>). Prenez le YAML suivant.</p>
<pre><code>---
title: "Dune"
author: "Frank Herbert"
date: "1965-08-01"
output: github_document
---</code></pre>
<p>Le titre, lâ€™auteur et la date sont spÃ©cifiÃ©s. Pour indiquer la date courante, on peut simplement la gÃ©nÃ©rer avec R en remplaÃ§ant <code>"1965-08-01"</code> par 2024-02-29. La spÃ©cification <code>output</code> indique le type de document Ã  gÃ©nÃ©rer, par exemple <code>html_document</code> pour une page web, <code>pdf_document</code> pour un pdf, ou <code>word_document</code> pour un docx. Dans ce cas-ci, jâ€™indique <code>github_document</code> pour crÃ©er un fichier markdown comprenant notamment des liens relatifs vers les images des graphiques gÃ©nÃ©rÃ©s. Pourquoi un <code>github_document</code>? Câ€™est le sujet de la <a href="#sec-intro-git">section&nbsp;<span>5.2</span></a>. Mais avant cela, je vous rÃ©fÃ¨re Ã  un autre aide-mÃ©moire.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-rmd-cs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="https://github.com/rstudio/cheatsheets/blob/main/pngs/rmarkdown.png?raw=true" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.8: <a href="https://github.com/rstudio/cheatsheets/blob/main/rmarkdown.pdf">Aide-mÃ©moire pour R Markdown, Source: RStudio</a></figcaption></figure>
</div>
</div>
</div>
</section></section><section id="quarto-markdown" class="level3" data-number="5.1.3"><h3 data-number="5.1.3" class="anchored" data-anchor-id="quarto-markdown">
<span class="header-section-number">5.1.3</span> Quarto markdown</h3>
<p>Avant dâ€™utiliser Quarto, il vous faudra lâ€™<a href="https://quarto.org/docs/download/">installer sur votre ordinateur</a>. Lorsque ce sera fait, une fois RStudio redÃ©marrÃ©, vous devriez pouvoir crÃ©er un document Quarto par <code>File &gt; New file &gt; Quarto Document</code>. Toutefois, je vous recommande plutÃ´t de crÃ©er directement un nouveau projet, et de choisir le type de projet sâ€™appliquant Ã  votre situation (typiquement un projet Quarto, mais le manuel de cours par exemple est un livre Quarto).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-qmd-proj" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_file-new-quarto.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.9: CrÃ©ation dâ€™un nouveau projet Quarto.</figcaption></figure>
</div>
</div>
</div>
<p>En crÃ©ant votre projet dans un nouveau rÃ©pertoire, vous pouvez choisir le moteur (ici nous utilisons <strong><code>knitr</code></strong>, mais vous pourriez aussi choisir <em>Jupyter</em> si vous prÃ©fÃ©rez) et activer le suivi dâ€™environnement reproductible <strong><code>renv</code></strong> (vous en apprendrez plus sur renv Ã  la <a href="#sec-git-renv">section&nbsp;<span>5.3</span></a>). De plus, vous pouvez directement crÃ©er un rÃ©pertoire git, ce qui facilitera les Ã©tapes dâ€™initialisation de votre rÃ©pertoire si vous souhaitez en faire un. Pour lâ€™instant, je vous suggÃ¨re de garder ces cases vides si vous souhaitez seulement utiliser Quarto.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-qmd-proj-options" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_project-new-quarto.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.10: Options de crÃ©ation dâ€™un nouveau projet Quarto.</figcaption></figure>
</div>
</div>
</div>
<p>Il existe un guide trÃ¨s dÃ©taillÃ© sur lâ€™utilisation de Quarto sur leur site internet. Je vous suggÃ¨re pour bien dÃ©marrer la <a href="https://quarto.org/docs/get-started/hello/rstudio.html">lecture suivante</a>.</p>
<section id="balises-des-blocs-de-code" class="level4" data-number="5.1.3.1"><h4 data-number="5.1.3.1" class="anchored" data-anchor-id="balises-des-blocs-de-code">
<span class="header-section-number">5.1.3.1</span> Balises des blocs de code</h4>
<p>En gÃ©nÃ©ral, vous pouvez utiliser les mÃªmes balises dans Quarto quâ€™avec R markdown. Les mÃªmes options peuvent Ãªtre utilisÃ©es Ã  lâ€™intÃ©rieur des accolades <code>{r}</code> de la mÃªme maniÃ¨re (par exemple : <code>{r, important-figure, fig.width = 10, fig.height = 5, fig.align = "center"}</code>), ou alors de faÃ§on plus claire avec le style YAML de la faÃ§on suivante :</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: important-figure</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"images/important-figure.png"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="rendu-de-documents" class="level4" data-number="5.1.3.2"><h4 data-number="5.1.3.2" class="anchored" data-anchor-id="rendu-de-documents">
<span class="header-section-number">5.1.3.2</span> Rendu de documents</h4>
<p>Pour crÃ©er le rendu de votre document, au lieu dâ€™utiliser le bouton <code>Knit</code>, vous pouvez utiliser <code>Render</code>. Si vos options permettent la sortie de plusieurs formats de fichiers, vous verrez une liste dÃ©roulante vous permettant de choisir le format Ã  produire.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-qmd-render" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="https://quarto.org/docs/get-started/hello/images/rstudio-render.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.11: CrÃ©er un rendu de votre document Quarto (<a href="https://quarto.org/docs/get-started/hello/rstudio.html">Tutorial: Hello Quarto</a>).</figcaption></figure>
</div>
</div>
</div>
<p>Ce bouton est bien pratique lorsque vous avez un seul document simple <code>.qmd</code> dans votre dossier ou alors que vous voulez rapidement visualiser une sortie, mais il est prÃ©fÃ©rable de prendre lâ€™habitude dâ€™utiliser la commande <code>quarto_render</code> pour faire le rendu de tous les fichiers dans le dossier. Certaines options de cette commande vous permettent par exemple de faire le rendu dâ€™un seul format de fichier.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"quarto"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>quarto<span class="sc">::</span><span class="fu">quarto_render</span>(<span class="st">"index.qmd"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="options-yaml" class="level4" data-number="5.1.3.3"><h4 data-number="5.1.3.3" class="anchored" data-anchor-id="options-yaml">
<span class="header-section-number">5.1.3.3</span> Options YAML</h4>
<p>Comme pour R markdown, nous utilisons le guide YAML pour spÃ©cifier les options de rendements de documents. On peut lâ€™utiliser directement en haut du fichier <code>.qmd</code> en en-tÃªte, mais en gÃ©nÃ©ral je recommande plutÃ´t dâ€™utiliser le fichier <code>_quarto.yml</code> qui devrait avoir Ã©tÃ© crÃ©Ã© dans votre dossier de projet lors de la crÃ©ation du projet. Vous pouvez y spÃ©cifier par exemple le dossier de sortie des fichiers crÃ©Ã©s, donner des paramÃ¨tres pour chaque format de fichiers de sortie, etc. Les informations dans ce fichier sont les consignes qui seront suivies lors de lâ€™interprÃ©tation et de la crÃ©ation de vos documents. Voici un exemple du contenu dâ€™un fichier YAML inspirÃ© du manuel des notes de cours.</p>
<pre><code>project:
  type: book
  output-dir: docs
  
book:
  title: "Titre livre"
  author:
  - name: "Nom auteur 1"
  - name: "Nom auteur 2"
  date: today
  date-format: iso
  chapters:
    - href: index.qmd
      text: PrÃ©face
    - 01-chap1.qmd
    - 02-chap2.qmd
  cover-image: images/cover.png
  
format:
  html:
    theme: flatly
    code-link: true
    css: styles.css
    toc: true
  pdf:
    documentclass: scrreprt
    toc: true</code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://github.com/rstudio/cheatsheets/blob/main/pngs/quarto.png?raw=true" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Aide-mÃ©moire de <a href="https://rstudio.github.io/cheatsheets/quarto.pdf">Quarto</a></figcaption></figure>
</div>
</section><section id="Ã©diteur-visuel" class="level4" data-number="5.1.3.4"><h4 data-number="5.1.3.4" class="anchored" data-anchor-id="Ã©diteur-visuel">
<span class="header-section-number">5.1.3.4</span> Ã‰diteur visuel</h4>
<p>Enfin, un des grands avantages de Quarto en termes dâ€™accessibilitÃ© est lâ€™Ã©diteur visuel. Personnellement, je prÃ©fÃ¨re gÃ©nÃ©ralement travailler avec lâ€™Ã©diteur de code Source, qui me permet de mieux voir ce quâ€™il se passe exactement et dâ€™avoir un meilleur contrÃ´le sur le formatage. Toutefois, il mâ€™arrive de passer Ã  lâ€™Ã©diteur visuel lorsque jâ€™ignore comment introduire certains Ã©lÃ©ments.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-qmd-editor" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="https://quarto.org/docs/get-started/hello/images/rstudio-source-visual.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.12: Ã‰diteur visuel vs source (<a href="https://quarto.org/docs/get-started/hello/rstudio.html">Tutorial: Hello Quarto</a>).</figcaption></figure>
</div>
</div>
</div>
<p>En mode dâ€™Ã©dition visuelle, il est trÃ¨s facile dâ€™insÃ©rer un nouvel Ã©lÃ©ment : il vous suffit de taper <code>/</code> : une liste dÃ©roulante devrait alors apparaÃ®tre. Vous pouvez alors choisir un Ã©lÃ©ment dans la liste, ou dâ€™abord spÃ©cifier votre recherche (comme Ã  la <a href="#fig-git-qmd-insert">Figure&nbsp;<span>5.13</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-qmd-insert" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="https://quarto.org/docs/get-started/authoring/images/rstudio-insert-equation.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.13: InsÃ©rer une Ã©quation avec lâ€™Ã©diteur visuel. (<a href="https://quarto.org/docs/get-started/authoring/rstudio.html">Tutorial: Authoring</a>).</figcaption></figure>
</div>
</div>
</div>
<p>Pour finir, il existe des modules vous permettant de crÃ©er directement un document Ã  partir de formats de rÃ©fÃ©rence. Par exemple, <a href="https://quarto.org/docs/journals/">quarto-journals</a> vous permet de crÃ©er rapidement des fichiers au format de votre revue prÃ©fÃ©rÃ©e. Puisque Quarto est plutÃ´t rÃ©cent, ces outils sont toujours en dÃ©veloppement et peuvent parfois Ãªtre imparfaits (ou inexistants pour votre revue), mais ils seront plus performants avec le temps et des revues devraient Ãªtre ajoutÃ©es.</p>
</section></section></section><section id="sec-intro-git" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="sec-intro-git">
<span class="header-section-number">5.2</span> Introduction Ã  GitHub</h2>
<p>Le systÃ¨me de suivi de version <strong><code>git</code></strong> (<em>open source</em>) a Ã©tÃ© crÃ©Ã© par Linus Torvalds, aussi connu pour avoir crÃ©Ã© Linux. <strong><code>git</code></strong> prend une photo de votre rÃ©pertoire de projet Ã  chaque fois que vous <em>commettez</em> un changement. Vous pourrez revenir sans problÃ¨me sur dâ€™anciennes versions si quelque chose tourne mal, et vous pourrez publier le rÃ©sultat final sur un service dâ€™hÃ©bergement utilisant <strong><code>git</code></strong>.</p>
<p>Il existe plusieurs services pour rendre <strong><code>git</code></strong> utilisable en ligne, mais GitHub est dÃ©finitivement le plus utilisÃ© dâ€™entre tous. La plateforme <a href="https://github.com/">GitHub</a> est presque devenue un rÃ©seau social de dÃ©veloppement. GitHub, maintenant la propriÃ©tÃ© de Microsoft, nâ€™est en soi pas <em>open source</em>. Si comme moi vous avez un penchant pour lâ€™<em>open source</em>, je vous redirige vers la plateforme <a href="https://about.gitlab.com/">GitLab</a>, qui fonctionne Ã  peu prÃ¨s de la mÃªme maniÃ¨re que GitHub, mais dans sa version gratuite GitLab vous octroie autant de rÃ©pertoires privÃ©s que vous dÃ©sirez. Seul hic, alors que la plateforme GitHub sera fort probablement toujours vivante dans plusieurs annÃ©es, on en est moins sÃ»r pour GitLab. Câ€™est pourquoi, en rÃ¨gle gÃ©nÃ©rale, jâ€™utilise <a href="https://github.com/essicolo">GitHub</a> Ã  des fins professionnelles mais <a href="https://gitlab.com/essicolo">GitLab</a> Ã  des fins personnelles.</p>
<p>Pour suivre cette partie du cours, je vous invite Ã  <a href="https://github.com/join?source=header-home">crÃ©er un compte sur GitHub</a> ou <a href="https://gitlab.com/users/sign_in">GitLab</a>, Ã  votre choix. CrÃ©ez un nouveau dÃ©pÃ´t (<em>New repository</em>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gith-new-repo" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_github-new-repo.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.14: Nouveau dÃ©pÃ´t avec GitHub</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gitl-new-repo" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_gitlab-new-repo.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.15: Nouveau dÃ©pÃ´t avec GitLab</figcaption></figure>
</div>
</div>
</div>
<p>Pour utiliser <strong><code>git</code></strong>, vous pourrez toujours travailler en ligne de commande (câ€™est ce que je prÃ©fÃ¨re personnellement mais je ne le conseille pas nÃ©cessairement; vous trouverez toute la documentation nÃ©cessaire sur le <a href="https://docs.github.com/fr/get-started/getting-started-with-git/set-up-git">site de GitHub</a>). Il est aussi possible de travailler avec les outils intÃ©grÃ©s dans <a href="https://docs.posit.co/ide/user/ide/guide/tools/version-control.html">RStudio</a>, mais je vous suggÃ¨re dâ€™utiliser <a href="https://desktop.github.com/">GitHub Desktop</a> (qui fonctionne aussi sur GitLab) - Ã©videmment, dâ€™<a href="https://git-scm.com/downloads/guis">autres logiciels similaires existent</a>. Github Desktop vous permettra dâ€™abord de <em>cloner</em> un rÃ©pertoire en ligne. Le clonage vous permet de crÃ©er une copie locale (sur votre ordinateur) du rÃ©pertoire.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gith-clone-repo" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_github-clone-repo.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.16: Cloner dÃ©pÃ´t avec GitHub</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gitl-clone-repo" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_gitlab-clone-repo.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.17: Cloner dÃ©pÃ´t avec GitLab</figcaption></figure>
</div>
</div>
</div>
<p>Une fois que le dÃ©pÃ´t est clonÃ©, il est sur votre ordinateur. Lorsque vous effectuez un changement, vous devez commettre (<em>commit</em>), puis envoyer (<em>push</em>) vos changements vers le dÃ©pÃ´t en ligne. Pour que votre document markdown soit lisible par GitHub et GitLab, il doit Ãªtre exportÃ© au format <code>html</code>. Un fichier <code>.md</code> sera crÃ©Ã©, et inclura les dÃ©tails de votre feuille de calculs, images y compris!</p>
<p>De plus, puisque les fichiers HTML gÃ©nÃ©rÃ©s par Quarto remplacent certains paramÃ¨tres des fichiers HTML classiques, vous devez ajouter dans le dossier racine de votre projet un fichier vide <code>.nojekyll</code> Ã  partir de votre terminal. Ce fichier indiquera GitHub dâ€™ignorer les procÃ©dures Jekyll quâ€™il lance normalement sur les fichiers HTML (voir <a href="https://quarto.org/docs/publishing/github-pages.html">site web de Quarto</a> pour plus de dÃ©tails).</p>
<table class="table">
<colgroup>
<col style="width: 22%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="odd">
<td>Mac/Linux</td>
<td><div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">touch</span> .nojekyll</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></td>
</tr>
<tr class="even">
<td>Windows</td>
<td><div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">copy</span> NUL .nojekyll</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-push-repo" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_github-push.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.18: Commettre et dÃ©ployer un dÃ©pÃ´t avec GitHub</figcaption></figure>
</div>
</div>
</div>
<p>Lâ€™interface de GitHub Desktop vous permet de revenir en arriÃ¨re en Ã©liminant des <em>commits</em> prÃ©cÃ©dents.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-revert" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_github-revert.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.19: Revenir en arriÃ¨re avec GitHub desktop</figcaption></figure>
</div>
</div>
</div>
<p>Vous pourrez ajouter des collaborateurs Ã  votre dÃ©pÃ´t, pour que plusieurs personnes travaillent de front sur un mÃªme dÃ©pÃ´t. Il est aussi possible de crÃ©er une branche dâ€™un dÃ©pÃ´t, fusionner la branche de dÃ©veloppement avec la branche principale, commenter les codes, suggÃ©rer des changements, etc., mais cela sort du cadre dâ€™un cours sur la reproductibilitÃ©.</p>
<p>Si vous souhaitez crÃ©er un site internet comme celui des notes de cours Ã  partir de votre rÃ©pertoire GitHub, vous devez activer votre page avec GitHub Pages, crÃ©er un lien, choisir la branche et le dossier contenant les fichiers HTML et publier.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-pages" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/05_git-pages.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.20: Activer la page avec GitHub Pages</figcaption></figure>
</div>
</div>
</div>
<p>Enfin, pour renvoyer un article vers votre matÃ©riel supplÃ©mentaire, insÃ©rez le lien dans la section mÃ©thodologie. Il peut sâ€™agir du lien complet, ou bien dâ€™un lien raccourci (avec par exemple <a href="https://tinyurl.com/app">tinyurl</a> ou <a href="https://bitly.com/">bitly</a>). Par exemple,</p>
<blockquote class="blockquote">
<p>The data and the R code used to compute the results are both available as supplementary material at https://git.io/fhHEj.</p>
</blockquote>
<p>Notez que RStudio offre une interface pour utiliser <strong><code>git</code></strong> via un onglet afichÃ© en haut Ã  droite dans lâ€™affichage par dÃ©faut. Ne lâ€™ayant jamais utilisÃ©, je ne me sens pas Ã  lâ€™aise dâ€™en suggÃ©rer lâ€™utilisation, mais libre Ã  vous dâ€™explorer cet outil et de vous lâ€™approprier!</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-rstudio-git" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="https://docs.posit.co/ide/user/ide/guide/tools/images/rstudio-vcs-pane-labeled.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.21: Lâ€™outil <em>Git</em> de RStudio</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-git-renv" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="sec-git-renv">
<span class="header-section-number">5.3</span> Introduction Ã  <strong><code>renv</code></strong>
</h2>
<p>Alors que les modules sont continuellement mis Ã  jour, on doit sâ€™assurer que lâ€™on sache exactement quelle version a Ã©tÃ© utilisÃ©e si lâ€™on dÃ©sire Ãªtre strict sur la reproductibilitÃ©. Lorsque je rÃ©vise un article, je demande Ã  ce que le nom des modules utilisÃ©s et leur numÃ©ro de version soient explicitement citÃ©s et rÃ©fÃ©rencÃ©s. Par exemple, dans un article sur lâ€™analyse de compositions foliaires de laitues inoculÃ©es par une bactÃ©rie, jâ€™Ã©crivais:</p>
<blockquote class="blockquote">
<p>Computations were performed in the R statistical language version 3.4.1 (R Development Core Team, 2017). The main packages used in the data analysis workflow were the vegan package version 2.4-3 (Oksanen et al., 2017) for ordination, the compositions package version 1.40-1 (van den Boogaart and Tolosana-Delgado, 2013) for ilr transformations, the nlme version 3.1-131 (Pinheiro et al., 2017) package to compute the random experimental effect, the mvoutlier package version 2.0.8 (Filzmoser and Gschwandtner, 2017) for multivariate outlier detection, and the ggplot2 package version 2.2.1 (Wickham and Chang, 2017) for data visualization. The data and computations are publicly available at https://github.com/essicolo/Nicolas-et-al_Infected-lettuce-ionomics. <a href="https://www.frontiersin.org/articles/10.3389/fpls.2019.00351">Nicolas et al., 2019</a></p>
</blockquote>
<p>De cette maniÃ¨re, une personne (que ce soit vos collÃ¨gues, quiconque voudra auditer ou Ã©valuer votre code ou vous-mÃªme dans le futur) pourra reproduire le code publiÃ© sur GitHub en installant les versions de R et des modules citÃ©s. Mais cela est fastidieux. Câ€™est pourquoi lâ€™Ã©quipe de RStudio (oui, encore ceux-lÃ ) ont dÃ©veloppÃ© le module <a href="https://rstudio.github.io/renv/"><strong><code>renv</code></strong></a>, qui permet dâ€™installer les modules Ã  mÃªme votre dossier de projet (le dossier contenant le fichier <code>.Rproj</code>).</p>
<p>Pour lâ€™utiliser Ã  tout moment en cours de projet, il suffit de lancer la commande <code>renv::init()</code>. Cette commande configure lâ€™infrastructure du projet, installe les libraries utilisÃ©es dans le dossier <code>renv</code> Ã  lâ€™intÃ©rieur du dossier de projet et bloque leurs versions actuelles dans le fichier <code>renv.lock</code>, crÃ©e un fichier <code>.Rprofile</code> qui traquera les installations futures de librairies supplÃ©mentaires, puis redÃ©marre la session R. Ouf!</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-git-renv-workflow" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="https://rstudio.github.io/renv/articles/renv.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.22: Lâ€™outil <em>renv</em> de RStudio</figcaption></figure>
</div>
</div>
</div>
<p>Dans le dossier <code>renv</code>, le <code>.gitignore</code> contient tous les documents et les types de documents qui sont ignorÃ©s par <strong><code>git</code></strong>. Lâ€™option par dÃ©faut est dâ€™ignorer le dossier <code>library</code>, qui contient les modules installÃ©s, mais de garder les fichiers <code>activate.R</code> et <code>settings.json</code>, qui contiennent le script dâ€™installation des modules non installÃ©s (qui devront Ãªtre installÃ©s par les autres personnes utilisant votre projet) ainsi que les paramÃ¨tres du projet. Mieux vaut garder les options par dÃ©faut. Initialiser <em>renv</em> revient Ã  scanner vos documents de projet pour trouver les modules utilisÃ©s et crÃ©er un paquet contenant tout cela Ã  mÃªme votre projet, dans un dossier <code>renv</code>.</p>
<pre><code>
ğŸ“‚ rstats
|-ğŸ“ data
|-ğŸ“ docs
|-ğŸ“ images
|-ğŸ“ lib
|-ğŸ“ renv
|-ğŸ“ tables
ğŸ“„ _quarto.yml
ğŸ“„ sentier-d-or.Rproj
ğŸ“„ stats.qmd
ğŸ“„ README.md
ğŸ“„ renv.lock
ğŸ“„ .Rprofile
ğŸ“„ .gitignore</code></pre>
<p>Ce dossier contiendra tout ce quâ€™il faut pour utiliser les modules du projet dâ€™une personne que lâ€™on nommera Leto. Lorsquâ€™une autre personne, appellons-la Ghanima, utilisera le projet de Leto, RStudio vÃ©rifiera si le module <strong><code>renv</code></strong> est bien installÃ©, et lâ€™installera sâ€™il ne lâ€™est pas. Pour utiliser les modules du projet et non pas les modules de son ordinateur, Ghanima lancera la fonction <code>renv::restore()</code>, qui installera les versions dÃ©crites dans le <em>lockfile</em> (<code>renv.lock</code>). Si Leto dÃ©cide de mettre Ã  jour ses modules en cours de projet, il lancera la fonction <code>renv::install()</code> pour installer de nouveaux modules, <code>renv::update()</code> pour faire la mise Ã  jour de tous les modules utilisÃ©s, puis <code>renv::snapshot()</code> pour que ces nouveaux modules soit intÃ©grÃ©s Ã  son projet dans le lockfile. Lorsque Leto commettra (<em>commit</em>) ses changements dans git et les publiera (<em>push</em>) sur GitHub, puis lorsque Ghanima mettra Ã  jour (<em>fetch</em>) son dÃ©pÃ´t local git liÃ© au dÃ©pÃ´t GitHub, elle devra Ã  nouveau lancer <code>renv::restore()</code> pour que les modules soient bel et bien ceux utilisÃ©s par Leto.</p>
<p>Notez quâ€™avec <code>renv</code>, vous nâ€™installez pas rÃ©ellement les modules complets Ã  chaque fois : <code>renv</code> garde en mÃ©moire cache lâ€™installation des modules sur votre ordinateur, si bien que lorsque vous installez plusieurs la mÃªme version dâ€™un mÃªme module, vous ne compilez pas Ã  chaque fois et vous nâ€™utilisez pas plus dâ€™espace sur votre disque dur quâ€™il nâ€™en faut.</p>
</section><section id="pour-terminer-le-reprex" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="pour-terminer-le-reprex">
<span class="header-section-number">5.4</span> Pour terminer, le <strong>reprex</strong>
</h2>
<p>Lorsque jâ€™ai dÃ©couvert un bogue dans le module <strong><code>weathercan</code></strong>, <a href="https://github.com/ropensci/weathercan/issues/70">jâ€™ai ouvert une <em>issue</em> sur GitHub</a> en indiquant le message dâ€™erreur obtenu, en espÃ©rant que lâ€™origine du bogue puisse Ãªtre facilement dÃ©duit. Un dÃ©veloppeur de <strong><code>weathercan</code></strong> mâ€™a demandÃ© un <strong>reprex</strong>. Jâ€™ai Ã©tÃ© dÃ©Ã§u lorsque jâ€™ai compris que le <strong>reprex</strong> nâ€™Ã©tait pas une espÃ¨ce de dinosaure, mais plutÃ´t un exemple reproductible (<em><strong>re</strong>producible <strong>ex</strong>ample</em>).</p>
<blockquote class="blockquote">
<p>ğŸ“— <strong>Reprex</strong>: Un exemple reproductible.</p>
</blockquote>
<p><img src="https://media.giphy.com/media/fdLR6LGwAiVNhGQNvf/giphy.gif" class="img-fluid"></p>
<p>Jâ€™ai essayÃ© dâ€™isoler le problÃ¨me pour reproduire lâ€™erreur avec le minimum de code possible. Ã€ partir dâ€™un code de plus de 7000 lignes (les prÃ©sentes notes de cours), jâ€™en suis arrivÃ© Ã  ceci:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/weathercan/">"weathercan"</a></span><span class="op">)</span></span>
<span><span class="va">mont_bellevue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/weathercan/reference/weather_dl.html">weather_dl</a></span><span class="op">(</span></span>
<span>  station_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5397</span>, <span class="fl">48371</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"2019-02-01"</span>,</span>
<span>  end <span class="op">=</span> <span class="st">"2019-02-07"</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"hour"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>, qui me retournait lâ€™erreur</p>
<pre><code>Getting station: 5397
Formatting station data: 5397
Error in strptime(xx, f, tz = tz) : valeur 'tz' incorrecte</code></pre>
<p>Le bogue: la fonction <code><a href="https://docs.ropensci.org/weathercan/reference/weather_dl.html">weather_dl()</a></code> utilisait Ã  lâ€™interne un objet nommÃ© <code>stations</code>, qui entrait en conflit avec un objet <code>stations</code> sâ€™il Ã©tait dÃ©fini hors de la fonction.</p>
<p>SynthÃ©tiser une question nâ€™est pas facile (crÃ©er cet exemple reprductible mâ€™a pris prÃ¨s de 2 heures). Mais rÃ©pondre Ã  une question non synthÃ©tisÃ©e, câ€™est encore plus difficile. Câ€™est pourquoi on (moi y compris) vous demandera systÃ©matiquement un <em>reprex</em> lorsque vous poserez une question liÃ©e Ã  une erreur systÃ©matique, le plus souvent en programmation.</p>
<blockquote class="blockquote">
<p>Un exemple reproductible permet Ã  quelquâ€™un de recrÃ©er lâ€™erreur que vous avez obtenue simplement en copiant-collant votre code. - <a href="https://gist.github.com/hadley/270442">Hadley Wickham</a></p>
</blockquote>
<p>Selon <a href="https://gist.github.com/hadley/270442">Hadley Wickham</a> (gourou de R), un <em>reprex</em> devrait comprendre quatre Ã©lÃ©ments (je joue Ã  lâ€™hÃ©rÃ©tique en me permettant dâ€™adapter le document du gourou):</p>
<ol type="1">
<li>Les modules devraient Ãªtre chargÃ©s en dÃ©but de code.</li>
<li>Puis vous chargez des donnÃ©es, qui peuvent Ãªtre des donnÃ©es dâ€™exemple ou des donnÃ©es incluses Ã  mÃªme le code R (comme des donnÃ©es gÃ©nÃ©rÃ©es au hasard).</li>
<li>Assurez-vous que votre code est un exemple minimal (retirer le superflu) et quâ€™il soit facilement lisible.</li>
<li>Incluez la sortie de la fonction <code><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo()</a></code>, qui indique la plateforme matÃ©rielle et logicielle sur laquelle vous avez gÃ©nÃ©rÃ© lâ€™erreur. Ceci est important en particulier sâ€™il sâ€™agit dâ€™un bogue.</li>
</ol>
<p>Lorsque vous pensez avoir gÃ©nÃ©rÃ© votre <em>reprex</em>, redÃ©marrez R (<code>Session &gt; Restart R</code> dans RStudio), puis lancez votre code pour vous assurer que lâ€™erreur puisse Ãªtre gÃ©nÃ©rÃ©e dans un nouvel environnement tout propre.</p>
<p>La librarie <a href="https://reprex.tidyverse.org/"><strong><code>reprex</code></strong></a> de tidyverse vous aide Ã  gÃ©nÃ©rer et Ã  tester des exemples reproductibles en vous fournissant un bloc de code au format markdown que vous pouvez directement copier-coller sur GitHub, StackOverflow ou Discourse (les lieux frÃ©quents oÃ¹ vous poserez vos questions).</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./04-visualisation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Visualisation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-python.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction Ã  Python</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Analyse et modÃ©lisation dâ€™agroÃ©cosystÃ¨mes est construit avec <a href="https://quarto.org/">Quarto</a>.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Lien vers le <a href="https://essicolo.github.io/ecologie-mathematique-R/">manuel original</a>.</div>
  </div>
</footer>


</body></html>