<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Analyse et modélisation d’agroécosystèmes sur R - 7&nbsp; Biostatistiques</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07b-bayes.html" rel="next">
<link href="./06-python.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07a-biostats.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Biostatistiques</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analyse et modélisation d’agroécosystèmes sur R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/chavalli/ecologie-mathematique-R/tree/h2024" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">La science des données avec R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-tableaux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Organisation des données et opérations sur des tableaux</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Visualisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Science ouverte et reproductibilité</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction à Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07a-biostats.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Biostatistiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07b-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction à l’analyse bayésienne en écologie</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-explorer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Explorer R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Association, partitionnement et ordination</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-imputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Détection de valeurs aberrantes et imputation de données manquantes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-series-temporelles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Les séries temporelles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-autoapprentissage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction à l’autoapprentissage</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-donnees-spatiales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Les données géospatiales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-modelisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modélisation de mécanismes écologiques</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#populations-et-%C3%A9chantillons" id="toc-populations-et-échantillons" class="nav-link active" data-scroll-target="#populations-et-%C3%A9chantillons"><span class="header-section-number">7.1</span> Populations et échantillons</a></li>
  <li>
<a href="#les-variables" id="toc-les-variables" class="nav-link" data-scroll-target="#les-variables"><span class="header-section-number">7.2</span> Les variables</a>
  <ul class="collapse">
<li><a href="#variables-quantitatives" id="toc-variables-quantitatives" class="nav-link" data-scroll-target="#variables-quantitatives"><span class="header-section-number">7.2.1</span> Variables quantitatives</a></li>
  <li><a href="#variables-qualitatives" id="toc-variables-qualitatives" class="nav-link" data-scroll-target="#variables-qualitatives"><span class="header-section-number">7.2.2</span> Variables qualitatives</a></li>
  </ul>
</li>
  <li><a href="#les-probabilit%C3%A9s" id="toc-les-probabilités" class="nav-link" data-scroll-target="#les-probabilit%C3%A9s"><span class="header-section-number">7.3</span> Les probabilités</a></li>
  <li>
<a href="#les-distributions" id="toc-les-distributions" class="nav-link" data-scroll-target="#les-distributions"><span class="header-section-number">7.4</span> Les distributions</a>
  <ul class="collapse">
<li><a href="#distribution-binomiale" id="toc-distribution-binomiale" class="nav-link" data-scroll-target="#distribution-binomiale"><span class="header-section-number">7.4.1</span> Distribution binomiale</a></li>
  <li><a href="#distribution-de-poisson" id="toc-distribution-de-poisson" class="nav-link" data-scroll-target="#distribution-de-poisson"><span class="header-section-number">7.4.2</span> Distribution de Poisson</a></li>
  <li><a href="#distribution-uniforme" id="toc-distribution-uniforme" class="nav-link" data-scroll-target="#distribution-uniforme"><span class="header-section-number">7.4.3</span> Distribution uniforme</a></li>
  <li><a href="#distribution-normale" id="toc-distribution-normale" class="nav-link" data-scroll-target="#distribution-normale"><span class="header-section-number">7.4.4</span> Distribution normale</a></li>
  </ul>
</li>
  <li><a href="#statistiques-descriptives" id="toc-statistiques-descriptives" class="nav-link" data-scroll-target="#statistiques-descriptives"><span class="header-section-number">7.5</span> Statistiques descriptives</a></li>
  <li>
<a href="#tests-dhypoth%C3%A8ses-%C3%A0-un-et-deux-%C3%A9chantillons" id="toc-tests-dhypothèses-à-un-et-deux-échantillons" class="nav-link" data-scroll-target="#tests-dhypoth%C3%A8ses-%C3%A0-un-et-deux-%C3%A9chantillons"><span class="header-section-number">7.6</span> Tests d’hypothèses à un et deux échantillons</a>
  <ul class="collapse">
<li><a href="#test-de-t-%C3%A0-un-seul-%C3%A9chantillon" id="toc-test-de-t-à-un-seul-échantillon" class="nav-link" data-scroll-target="#test-de-t-%C3%A0-un-seul-%C3%A9chantillon"><span class="header-section-number">7.6.1</span> Test de t à un seul échantillon</a></li>
  <li><a href="#attention-mauvaises-interpr%C3%A9tations-des-p-values" id="toc-attention-mauvaises-interprétations-des-p-values" class="nav-link" data-scroll-target="#attention-mauvaises-interpr%C3%A9tations-des-p-values"><span class="header-section-number">7.6.2</span> Attention: mauvaises interprétations des <em>p-values</em></a></li>
  <li><a href="#test-de-wilcoxon-%C3%A0-un-seul-%C3%A9chantillon" id="toc-test-de-wilcoxon-à-un-seul-échantillon" class="nav-link" data-scroll-target="#test-de-wilcoxon-%C3%A0-un-seul-%C3%A9chantillon"><span class="header-section-number">7.6.3</span> Test de Wilcoxon à un seul échantillon</a></li>
  <li><a href="#tests-de-t-%C3%A0-deux-%C3%A9chantillons" id="toc-tests-de-t-à-deux-échantillons" class="nav-link" data-scroll-target="#tests-de-t-%C3%A0-deux-%C3%A9chantillons"><span class="header-section-number">7.6.4</span> Tests de t à deux échantillons</a></li>
  <li><a href="#comparaison-des-variances" id="toc-comparaison-des-variances" class="nav-link" data-scroll-target="#comparaison-des-variances"><span class="header-section-number">7.6.5</span> Comparaison des variances</a></li>
  <li><a href="#tests-de-wilcoxon-%C3%A0-deux-%C3%A9chantillons" id="toc-tests-de-wilcoxon-à-deux-échantillons" class="nav-link" data-scroll-target="#tests-de-wilcoxon-%C3%A0-deux-%C3%A9chantillons"><span class="header-section-number">7.6.6</span> Tests de Wilcoxon à deux échantillons</a></li>
  <li><a href="#les-tests-pair%C3%A9s" id="toc-les-tests-pairés" class="nav-link" data-scroll-target="#les-tests-pair%C3%A9s"><span class="header-section-number">7.6.7</span> Les tests pairés</a></li>
  </ul>
</li>
  <li><a href="#lanalyse-de-variance" id="toc-lanalyse-de-variance" class="nav-link" data-scroll-target="#lanalyse-de-variance"><span class="header-section-number">7.7</span> L’analyse de variance</a></li>
  <li>
<a href="#sec-bios-models" id="toc-sec-bios-models" class="nav-link" data-scroll-target="#sec-bios-models"><span class="header-section-number">7.8</span> Les modèles statistiques</a>
  <ul class="collapse">
<li><a href="#mod%C3%A8les-%C3%A0-effets-fixes" id="toc-modèles-à-effets-fixes" class="nav-link" data-scroll-target="#mod%C3%A8les-%C3%A0-effets-fixes"><span class="header-section-number">7.8.1</span> Modèles à effets fixes</a></li>
  <li><a href="#mod%C3%A8les-%C3%A0-effets-mixtes" id="toc-modèles-à-effets-mixtes" class="nav-link" data-scroll-target="#mod%C3%A8les-%C3%A0-effets-mixtes"><span class="header-section-number">7.8.2</span> Modèles à effets mixtes</a></li>
  <li><a href="#aller-plus-loin" id="toc-aller-plus-loin" class="nav-link" data-scroll-target="#aller-plus-loin"><span class="header-section-number">7.8.3</span> Aller plus loin</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-bios" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Biostatistiques</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><hr>
<p><strong>Objectifs spécifiques</strong>:</p>
<p>À la fin de ce chapitre, vous</p>
<ul>
<li>serez en mesure de définir les concepts de base en statistique: population, échantillon, variable, probabilité et distribution</li>
<li>serez en mesure de calculer des statistiques descriptives de base: moyenne et écart-type, quartiles, maximum et minimum</li>
<li>comprendrez les notions de test d’hypothèse, d’effet et de p-value, ainsi qu’éviter les erreurs communes dans leur interprétation</li>
<li>saurez effectuer une modélisation statistique linéaire simple, multiple et mixte, entre autres sur des catégories</li>
<li>saurez effectuer une modélisation statistique non linéaire simple, multiple et mixte</li>
</ul>
<hr>
<p>Aux chapitres précédents, nous avons vu comment visualiser, organiser et manipuler des tableaux de données. La statistique est une collection de disciplines liées à la collecte, l’organisation, l’analyse, l’interprétation et la présentation de données. Les biostatistiques sont des applications de ces disciplines à la biosphère.</p>
<p>Dans <a href="https://ulaval.on.worldcat.org/oclc/1131250331"><em>Principles and procedures of statistics: A biometrical approach</em></a>, Steel, Torie et Dickey (1997) définissent les statistiques ainsi:</p>
<blockquote class="blockquote">
<p>Les statistiques forment la science, pure et appliquée, de la création, du développement, et de l’application de techniques par lesquelles l’incertitude de l’induction inférentielle peut être évaluée. (ma traduction)</p>
</blockquote>
<p>Alors que l’<strong>inférence</strong> consiste à généraliser des échantillons à l’ensemble d’une population, l’<strong>induction</strong> est un type de raisonnement qui permet de généraliser des observations sous forme de théories. En d’autres mots, les statistiques permettent d’évaluer l’incertitude sur des processus, de passer par inférence de l’échantillon à la population, puis passer cette représentation par induction d’une population en lois générales la concernant.</p>
<p>La définition de Whitlock et Schuluter (2015), dans <a href="http://whitlockschluter.zoology.ubc.ca/">The Analysis of Biological Data</a>, est plus simple et n’insiste que sur l’inférence:</p>
<blockquote class="blockquote">
<p>La statistique est l’étude des méthodes pour mesurer des aspects de populations à partir d’échantillons et pour quantifier l’incertitude des mesures. (ma traduction)</p>
</blockquote>
<p>Les statistiques consistent à <em>faire du sens</em> (anglicisme assumé) avec des observations dans l’objectif de répondre à une question que vous aurez formulée clairement, préalablement à votre expérience.</p>
<blockquote class="twitter-tweet blockquote" data-lang="fr">
<p lang="en" dir="ltr">
</p>
<p>The more time I spend as The Statistician in the room, the more I think the best skill you can cultivate is the ability to remain calm and repeatedly ask “What question are you trying to answer?”</p>

<p>— Bryan Howie (<span class="citation" data-cites="bryan_howie">@bryan_howie</span>) <a href="https://twitter.com/bryan_howie/status/1073054519808876544?ref_src=twsrc%5Etfw">13 décembre 2018</a></p>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><p>Le flux de travail conventionnel en statistiques consiste à collecter des échantillons, transformer (prétraiter) les données, effectuer des tests, analyser les résultats, les interpréter et les visualiser.</p>
<p><span class="math display">\[Collecte \rightarrow Prétraitement \rightarrow Tests~statistiques \rightarrow Analyse \rightarrow Interprétation \rightarrow Visualisation \]</span></p>
<p>Ce chapitre à lui seul est trop court pour permettre d’intégrer toutes les connaissances nécessaires à une utilisation raisonnée des statistiques, mais fournit les bases pour aller plus loin. Notez que les erreurs d’interprétation statistiques sont courantes et la consultation de spécialistes n’est souvent pas un luxe. Mais bien que les statistiques soient complexes, <em>la plupart des opérations statistiques peuvent être effectuées sans l’assistance de statisticien.ne.s</em>… à condition de comprendre suffisamment les concepts utilisés.</p>
<p>Dans ce chapitre, nous verrons comment répondre correctement à une question valide et adéquate avec l’aide d’outils de calcul scientifique. Nous couvrirons les notions de base des distributions et des variables aléatoires qui nous permettront d’effectuer des tests statistiques communs avec R. Nous couvrirons aussi les erreurs communément commises en recherche académique et les moyens simples de les éviter.</p>
<p>En plus des modules de base de R nous utiliserons</p>
<ul>
<li>les modules de la <strong><code>tidyverse</code></strong>,</li>
<li>le module de données agricoles <strong><code>agridat</code></strong>, ainsi que</li>
<li>le module <strong><code>nlme</code></strong> spécialisé pour la modélisation mixte.</li>
</ul>
<p>Avant de survoler les applications statistiques avec R, je vais rapidement présenter quelques notions importantes en statistiques : populations et échantillons, variables, probabilités et distributions. Ensuite, nous allons effectuer des tests d’hypothèse univariés (notamment les tests de <em>t</em> et les analyses de variance) et détailler la notion controversée de <em>p-value</em>. Je vais m’attarder plus longuement aux modèles linéaires généralisés, incluant en particulier des effets fixes et aléatoires (modèles mixtes), qui fournissent une trousse d’analyse polyvalente en analyse multivariée. Je terminerai avec les perspectives multivariées que sont les matrices de covariance et de corrélation.</p>
<section id="populations-et-échantillons" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="populations-et-échantillons">
<span class="header-section-number">7.1</span> Populations et échantillons</h2>
<p>Le principe d’inférence consiste à généraliser des conclusions à l’échelle d’une population à partir d’échantillons issus de cette population. Alors qu’une <strong>population</strong> contient tous les éléments étudiés, un <strong>échantillon</strong> d’une population est une observation unique. Une expérience bien conçue fera en sorte que les échantillons soient représentatifs de la population qui, la plupart du temps, ne peut être observée entièrement pour des raisons pratiques.</p>
<p>Les principes d’expérimentation servant de base à la conception d’une bonne méthodologie sont présentés dans le cours <a href="https://www.ulaval.ca/les-etudes/cours/repertoire/detailsCours/bvg-7002-dispositifs-experimentaux.html"><em>Dispositifs expérimentaux (BVG-7002)</em></a>. Également, je recommande le livre <em>Principes d’expérimentation: planification des expériences et analyse de leurs résultats</em> de Pierre Dagnelie (2012), <a href="https://file.lib.uliege.be/ebook/www/Dagnelies2012.pdf">disponible en ligne en format PDF</a>. Un bon aperçu des dispositifs expérimentaux est aussi présenté dans <a href="https://www.springer.com/us/book/9780387790534"><em>Introductory Statistics with R</em></a>, de Peter Dalgaard (2008), que vous pouvez télécharger <a href="https://ulaval.on.worldcat.org/oclc/759004956">du site de la bibliothèque de l’Université Laval</a> vous avez un identifiant autorisé.</p>
<p>Une population est échantillonnée pour induire des <strong>paramètres</strong>: un rendement typique dans des conditions météorologiques, édaphiques et managériales données, la masse typique des faucons pèlerins, mâles et femelles, le microbiome typique d’un sol agricole ou forestier, etc. Une <strong>statistique</strong> est une estimation d’un paramètre calculée à partir des données, par exemple une moyenne et un écart-type, ou une ordonnée à l’origine (<em>intercept</em>) et une pente.</p>
<p>Par exemple, la moyenne (<span class="math inline">\(\mu\)</span>) et l’écart-type (<span class="math inline">\(\sigma\)</span>) d’une population sont estimés par les moyennes (<span class="math inline">\(\bar{x}\)</span>) et écarts-types (<span class="math inline">\(s\)</span>) calculés sur les données issues de l’échantillonnage.</p>
<p>Chaque paramètre est liée à une perspective que l’on désire connaître chez une population. Ces angles d’observations sont les <strong>variables</strong>.</p>
</section><section id="les-variables" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="les-variables">
<span class="header-section-number">7.2</span> Les variables</h2>
<p>Nous avons abordé au <a href="03-tableaux.html">chapitre&nbsp;<span>3</span></a> la notion de <em>variable</em> par l’intermédiaire d’une donnée. Une variable est l’observation d’une caractéristique décrivant un échantillon. Si la charactéristique varie d’un échantillon à un autre sans que vous en expliquiez la raison (i.e.&nbsp;si identifier la source de la variabilité ne fait pas partie de votre expérience), on parlera de variable aléatoire. Même le hasard est régi par certaines lois: ce qui est aléatoire dans une variable peut être décrit par des <strong>lois de probabilité</strong>, que nous verrons plus bas.</p>
<p>Mais restons aux variables pour l’instant. Par convention, on peut attribuer aux variables un symbole mathématique. Par exemple, on peut donner à la masse volumique d’un sol (qui est le résultat d’une méthodologie précise) le symbole <span class="math inline">\(\rho\)</span>. Lorsque l’on attribue une valeur à <span class="math inline">\(\rho\)</span>, on parle d’une donnée. Chaque donnée d’une observation a un indice qui lui est propre, que l’on désigne souvent par <span class="math inline">\(i\)</span>, que l’on place en indice <span class="math inline">\(\rho_i\)</span>. Pour la première donnée, on a <span class="math inline">\(i=1\)</span>, donc <span class="math inline">\(\rho_1\)</span>. Pour un nombre <span class="math inline">\(n\)</span> d’échantillons, on aura <span class="math inline">\(\rho_1\)</span>, <span class="math inline">\(\rho_2\)</span>, <span class="math inline">\(\rho_3\)</span>, …, <span class="math inline">\(\rho_n\)</span>, formant le vecteur <span class="math inline">\(\rho = \left[\rho_1, \rho_2, \rho_3, ..., \rho_n \right]\)</span>.</p>
<p>En R, une variable est associée à un vecteur ou une colonne d’un tableau.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.34</span>, <span class="fl">1.52</span>, <span class="fl">1.26</span>, <span class="fl">1.43</span>, <span class="fl">1.39</span><span class="op">)</span> <span class="co"># matrice 1D</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span> <span class="co"># tableau</span></span>
<span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   rho
1 1.34
2 1.52
3 1.26
4 1.43
5 1.39</code></pre>
</div>
</div>
<p>Il existe plusieurs types de variables, qui se regroupent en deux grandes catégories: les <strong>variables quantitatives</strong> et les <strong>variables qualitatives</strong>.</p>
<section id="variables-quantitatives" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="variables-quantitatives">
<span class="header-section-number">7.2.1</span> Variables quantitatives</h3>
<p>Ces variables peuvent être continues dans un espace échantillonnal réel ou discrètes dans un espace échantillonnal ne considérant que des valeurs fixes. Notons que la notion de nombre réel est toujours une approximation en sciences expérimentales comme en calcul numérique, étant donnée que l’on est limité par la précision des appareils comme par le nombre d’octets à utiliser. Bien que les valeurs fixes des distributions discrètes ne soient pas toujours des valeurs entières, c’est bien souvent le cas en biostatistiques comme en démographie, où les décomptes d’individus sont souvent présents (et où la notion de fraction d’individus n’est pas acceptée).</p>
</section><section id="variables-qualitatives" class="level3" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="variables-qualitatives">
<span class="header-section-number">7.2.2</span> Variables qualitatives</h3>
<p>On exprime parfois qu’une variable qualitative est une variable impossible à mesurer numériquement: une couleur, l’appartenance à une espèce ou à une série de sol. Pourtant, dans bien des cas, les variables qualitatives peuvent être encodées en variables quantitatives. Par exemple, on peut accoler des pourcentages de sable, limon et argile à un loam sableux, qui autrement est décrit par la classe texturale d’un sol. Pour une couleur, on peut lui associer une longueur d’onde ou des pourcentages de rouge, vert et bleu, ainsi qu’un ton. En ce qui a trait aux variables ordonnées, il est possible de supposer un étalement. Par exemple, une variable d’intensité faible-moyenne-forte peut être transformée linéairement en valeurs quantitatives -1, 0 et 1. Attention toutefois, l’étalement peut parfois être quadratique ou logarithmique. Les séries de sol peuvent être encodées par la proportion de gleyfication (<a href="https://www.frontiersin.org/articles/10.3389/fenvs.2017.00081/full">Parent et al., 2017</a>). Quant aux catégories difficilement transformables en quantités, on pourra passer par l’<strong>encodage catégoriel</strong>, souvent appelé <em>dummyfication</em>, que nous verrons plus loin. L’analyse qualitative consiste en l’analyse de verbatims, essentiellement utile en sciences sociales: nous n’en n’aurons pas besoin ici. Nous considérerons les variables qualitatives comme des variables quantitatives qui n’ont pas subi de prétraitement.</p>
</section></section><section id="les-probabilités" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="les-probabilités">
<span class="header-section-number">7.3</span> Les probabilités</h2>
<blockquote class="blockquote">
<p>« Nous sommes si éloignés de connaître tous les agens de la nature, et leurs divers modes d’action ; qu’il ne serait pas philosophique de nier les phénomènes, uniquement parce qu’ils sont inexplicables dans l’état actuel de nos connaissances. Seulement, nous devons les examiner avec une attention d’autant plus scrupuleuse, qu’il paraît plus difficile de les admettre ; et c’est ici que le calcul des probabilités devient indispensable, pour déterminer jusqu’à quel point il faut multiplier les observations ou les expériences, afin d’obtenir en faveur des agens qu’elles indiquent, une probabilité supérieure aux raisons que l’on peut avoir d’ailleurs, de ne pas les admettre. » — Pierre-Simon de Laplace</p>
</blockquote>
<p>Une probabilité est la vraisemblance qu’un évènement se réalise chez un échantillon. Les probabilités forment le cadre des systèmes stochastiques, c’est-à-dire des systèmes trop complexes pour en connaître exactement les aboutissants, auxquels on attribue une part de hasard. Ces systèmes sont prédominants dans les processus vivants.</p>
<p>On peut dégager deux perspectives sur les probabilités: l’une passe par une interprétation fréquentielle, l’autre bayésienne.</p>
<ul>
<li>L’interprétation <strong>fréquentielle</strong> représente la fréquence des occurrences après un nombre infini d’évènements. Par exemple, si vous jouez à pile ou face un grand nombre de fois, le nombre de pile sera égal à la moitié du nombre de lancers. <em>L’approche fréquentielle teste si les données concordent avec un modèle du réel</em>. Il s’agit de l’interprétation communément utilisée.</li>
<li>L’interprétation <strong>bayésienne</strong> vise à quantifier l’incertitude des phénomènes. Dans cette perspective, plus l’information s’accumule, plus l’incertitude diminue. Cette approche gagne en notoriété notamment parce qu’elle permet de décrire des phénomènes qui, intrinsèquement, ne peuvent être répétés infiniment (absence d’asymptote), comme ceux qui sont bien définis dans le temps ou sur des populations limitées. <em>L’approche bayésienne évalue la probabilité que le modèle soit réel</em>.</li>
</ul>
<p>Une erreur courante consiste à aborder des statistiques fréquentielles comme des statistiques bayésiennes. Par exemple, si l’on désire évaluer la probabilité de l’existence de vie sur Mars, on devra passer par le bayésien, car avec les stats fréquentielles, on devra plutôt conclure si les données sont conformes ou non avec l’hypothèse de la vie sur Mars (exemple tirée du blogue <a href="https://dynamicecology.wordpress.com/2011/10/11/frequentist-vs-bayesian-statistics-resources-to-help-you-choose/">Dynamic Ecology</a>).</p>
<p>Des rivalités factices s’installent entre les tenants des différentes approches, dont chacune, en réalité, répond à des questions différentes dont il convient réfléchir sur les limitations. Bien que les statistiques bayésiennes soient de plus en plus utilisées, nous ne couvrirons dans ce chapitre que l’approche fréquentielle. L’approche bayésienne est néanmoins traitée dans le <a href="07b-bayes.html">chapitre&nbsp;<span>8</span></a>, qui est facultatif au cours.</p>
</section><section id="les-distributions" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="les-distributions">
<span class="header-section-number">7.4</span> Les distributions</h2>
<p>Une variable aléatoire peut prendre des valeurs selon des modèles de distribution des probabilités. Une distribution est une fonction mathématique décrivant la probabilité d’observer une série d’évènements. Ces évènements peuvent être des valeurs continues, des nombres entiers, des catégories, des valeurs booléennes (Vrai/Faux), etc. Dépendemment du type de valeur et des observations obtenues, on peut associer des variables à différentes lois de probabilité. Toujours, l’aire sous la courbe d’une distribution de probabilité est égale à 1.</p>
<p>En statistiques inférentielles, les distributions sont les modèles, comprenant certains paramètres comme la moyenne et la variance pour les distributions normales, à partir desquelles les données sont générées.</p>
<p>Il existe deux grandes familles de distribution: <strong>discrètes</strong> et <strong>continues</strong>. Les distributions discrètes sont contraintes à des valeurs prédéfinies (finies ou infinies), alors que les distributions continues prennent nécessairement un nombre infini de valeurs, dont la probabilité ne peut pas être évaluée ponctuellement, mais sur un intervalle.</p>
<p>L’<strong>espérance</strong> mathématique est une fonction de tendance centrale, souvent décrite par un paramètre. Il s’agit de la moyenne d’une population pour une distribution normale. La <strong>variance</strong>, quant à elle, décrit la variabilité d’une population, i.e.&nbsp;son étalement autour de l’espérance. Pour une distribution normale, la variance d’une population est aussi appelée variance, souvent présentée par l’écart-type (égal à la racine carrée de la variance).</p>
<section id="distribution-binomiale" class="level3" data-number="7.4.1"><h3 data-number="7.4.1" class="anchored" data-anchor-id="distribution-binomiale">
<span class="header-section-number">7.4.1</span> Distribution binomiale</h3>
<p>En tant que scénario à deux issues possibles, des tirages à pile ou face suivent une loi binomiale, comme toute variable booléenne prenant une valeur vraie ou fausse. En biostatistiques, les cas communs sont la présence/absence d’une espèce, d’une maladie, d’un trait phylogénétique, ainsi que les catégories encodées. Lorsque l’opération ne comprend qu’un seul échantillon (i.e.&nbsp;un seul tirage à pile ou face), il s’agit d’un cas particulier d’une loi binomiale que l’on nomme une loi de <em>Bernouilli</em>.</p>
<p>Pour 25 tirages à pile ou face indépendants (i.e.&nbsp;dont l’ordre des tirages ne compte pas), on peut dessiner une courbe de distribution dont la somme des probabilités est de 1. La fonction <code>dbinom</code> est une fonction de distribution de probabilités. Les fonctions de distribution de probabilités discrètes sont appelées des fonctions de masse.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">25</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, size <span class="op">=</span> <span class="fl">25</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'La somme des probabilités est de'</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La somme des probabilités est de 1"</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, xend <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-binom-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="distribution-de-poisson" class="level3" data-number="7.4.2"><h3 data-number="7.4.2" class="anchored" data-anchor-id="distribution-de-poisson">
<span class="header-section-number">7.4.2</span> Distribution de Poisson</h3>
<p>La loi de Poisson (avec un P majuscule, introduite par le mathématicien français Siméon Denis Poisson et non pas l’animal) décrit des distributions discrètes de probabilité d’un nombre d’évènements se produisant dans l’espace ou dans le temps. Les distributions de Poisson décrivent ce qui tient du décompte. Il peut s’agir du nombre de grenouilles traversant une rue quotidiennement, du nombre de plants d’asclépiades se trouvant sur une terre cultivée, ou du nombre d’évènements de précipitation au mois de juin, etc. La distribution de Poisson n’a qu’un seul paramètre, <span class="math inline">\(\lambda\)</span>, qui décrit la moyenne des décomptes.</p>
<p>Par exemple, en un mois de 30 jours, et une moyenne de 8 évènements de précipitation pour ce mois, on obtient la distribution suivante.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">x</span>, lambda <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'La somme des probabilités est de'</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La somme des probabilités est de 0.999664536835124"</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, xend <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-poisson-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="distribution-uniforme" class="level3" data-number="7.4.3"><h3 data-number="7.4.3" class="anchored" data-anchor-id="distribution-uniforme">
<span class="header-section-number">7.4.3</span> Distribution uniforme</h3>
<p>La distribution la plus simple est probablement la distribution uniforme. Si la variable est discrète, chaque catégorie est associée à une probabilité égale. Si la variable est continue, la probabilité est directement proportionnelle à la largeur de l’intervalle. On utilise rarement la distribution uniforme en biostatistiques, sinon pour décrire des <em>a priori</em> vagues pour l’analyse bayésienne (ce sujet est traité dans le <a href="07b-bayes.html">chapitre&nbsp;<span>8</span></a>). Nous utilisons la fonction <code>dunif</code>. À la différence des distributions discrètes, les fonctions de distribution de probabilités continues sont appelées des fonctions de densité d’une loi de probabilité (<em>probability density function</em>).</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">increment</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, by <span class="op">=</span> <span class="va">increment</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">dunif</a></span><span class="op">(</span><span class="va">x</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, max <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">dunif</a></span><span class="op">(</span><span class="va">x</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, max <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">y3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">dunif</a></span><span class="op">(</span><span class="va">x</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'La somme des probabilités est de'</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y3</span> <span class="op">*</span> <span class="va">increment</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La somme des probabilités est de 1.005"</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gg_unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y1</span>, <span class="va">y2</span>, <span class="va">y3</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span>, names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gg_unif</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-unif-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="distribution-normale" class="level3" data-number="7.4.4"><h3 data-number="7.4.4" class="anchored" data-anchor-id="distribution-normale">
<span class="header-section-number">7.4.4</span> Distribution normale</h3>
<p>La plus répandue de ces lois est probablement la loi normale, parfois nommée loi gaussienne et plus rarement loi laplacienne. Il s’agit de la distribution classique en forme de cloche.</p>
<p>La loi normale est décrite par une moyenne, qui désigne la tendance centrale, et une variance, qui désigne l’étalement des probabilités autour de la moyenne. La racine carrée de la variance est l’écart-type.</p>
<p>Les distributions de mesures exclusivement positives (comme le poids ou la taille) sont parfois avantageusement approximées par une loi <strong>log-normale</strong>, qui est une loi normale sur le logarithme des valeurs: la moyenne d’une loi log-normale est la moyenne géométrique.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">increment</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="va">increment</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">y3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'La somme des probabilités est de'</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y3</span> <span class="op">*</span> <span class="va">increment</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La somme des probabilités est de 0.999147010743368"</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gg_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y1</span>, <span class="va">y2</span>, <span class="va">y3</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span>, names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gg_norm</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-norm-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Quelle est la probabilité d’obtenir le nombre 0 chez une observation continue distribuée normalement dont la moyenne est 0 et l’écart-type est de 1? Réponse: 0. La loi normale étant une distribution continue, les probabilités non-nulles ne peuvent être calculées que sur des intervalles. Par exemple, la probabilité de retrouver une valeur dans l’intervalle entre -1 et 2 est calculée en soustrayant la probabilité cumulée à -1 de la probabilité cumulée à 2.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">increment</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, by <span class="op">=</span> <span class="va">increment</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prob_between</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="va">gg_auc</span> <span class="op">&lt;-</span> <span class="va">gg_norm</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="va">prob_between</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span> <span class="op">&lt;</span> <span class="va">prob_between</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prob_between</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prob_between</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gg_auc</span>, fill <span class="op">=</span> <span class="st">'#71ad50'</span><span class="op">)</span> <span class="op">+</span> <span class="co"># #71ad50 est un code de couleur format hexadécimal</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-norm-prob-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prob_norm_between</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">prob_between</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">prob_between</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"La probabilité d'obtenir un nombre entre"</span>,</span>
<span>            <span class="va">prob_between</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"et"</span>,</span>
<span>            <span class="va">prob_between</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"est d'environ"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_norm_between</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La probabilité d'obtenir un nombre entre -1 et 2 est d'environ 82 %"</code></pre>
</div>
</div>
<p>La courbe normale peut être utile pour évaluer la distribution d’une population. Par exemple, on peut calculer les limites de région sur la courbe normale qui contient 95% des valeurs possibles en tranchant 2.5% de part et d’autre de la moyenne. Il s’agit ainsi de l’intervalle de confiance sur la déviation de la distribution.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">increment</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, by <span class="op">=</span> <span class="va">increment</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">prob_between</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="va">gg_auc</span> <span class="op">&lt;-</span> <span class="va">gg_norm</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="va">prob_between</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span> <span class="op">&lt;</span> <span class="va">prob_between</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prob_between</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prob_between</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gg_auc</span>, fill <span class="op">=</span> <span class="st">'#71ad50'</span><span class="op">)</span> <span class="op">+</span> <span class="co"># #71ad50 est un code de couleur format hexadécimal</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prob_between</span>,</span>
<span>                              y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                              labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_between</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">labels</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/biod-norm-ci-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On pourrait aussi être intéressé à l’intervalle de confiance sur la moyenne. En effet, la moyenne suit aussi une distribution normale, dont la tendance centrale est la moyenne de la distribution, et dont l’écart-type est noté <em>erreur standard</em>. On calcule cette erreur en divisant la variance par le nombre d’observation, ou en divisant l’écart-type par la racine carrée du nombre d’observations. Ainsi, pour 10 échantillons:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">increment</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, by <span class="op">=</span> <span class="va">increment</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">prob_between</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="va">gg_auc</span> <span class="op">&lt;-</span> <span class="va">gg_norm</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="va">prob_between</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span> <span class="op">&lt;</span> <span class="va">prob_between</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prob_between</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prob_between</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gg_auc</span>, fill <span class="op">=</span> <span class="st">'#71ad50'</span><span class="op">)</span> <span class="op">+</span> <span class="co"># #71ad50 est un code de couleur format hexadécimal</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prob_between</span>,</span>
<span>                              y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                              labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_between</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">labels</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-norm-mean-ci-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="statistiques-descriptives" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="statistiques-descriptives">
<span class="header-section-number">7.5</span> Statistiques descriptives</h2>
<p>On a vu comment générer des statistiques sommaires en R avec la fonction <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>. Reprenons les données d’iris.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"iris"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.350   Median :1.300  
 Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
       Species  
 setosa    :50  
 versicolor:50  
 virginica :50  
                
                
                </code></pre>
</div>
</div>
<p>Pour précisément effectuer une moyenne et un écart-type sur un vecteur, passons par les fonctions <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> et <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.843333</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8280661</code></pre>
</div>
</div>
<p>Pour effectuer un sommaire de tableau piloté par une fonction, nous passons par la gamme de fonctions <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>, de dplyr. Dans ce cas, avec <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>, nous fragmentons le tableau par espèce pour effectuer un sommaire sur toutes les variables.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_all</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Species    Sepal.Length Sepal.Width Petal.Length Petal.Width
  &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
1 setosa             5.01        3.43         1.46       0.246
2 versicolor         5.94        2.77         4.26       1.33 
3 virginica          6.59        2.97         5.55       2.03 </code></pre>
</div>
</div>
<p>Vous pourriez être intéressé par les quartiles à 25, 50 et 75%. Mais la fonction <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> n’autorise que les fonctions dont la sortie est d’un seul objet, alors faisons sorte que l’objet soit une liste - lorsque l’on imbrique une fonction <code>funs</code>, le tableau à insérer dans la fonction est indiqué par un <code>.</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>q25 <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.</span>, probs <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>                     q50 <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.</span>, probs <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span>,</span>
<span>                     q75 <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.</span>, probs <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 13
  Species    Sepal.Length_q25 Sepal.Width_q25 Petal.Length_q25 Petal.Width_q25
  &lt;fct&gt;                 &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt;
1 setosa                 4.8             3.2               1.4             0.2
2 versicolor             5.6             2.52              4               1.2
3 virginica              6.22            2.8               5.1             1.8
# ℹ 8 more variables: Sepal.Length_q50 &lt;dbl&gt;, Sepal.Width_q50 &lt;dbl&gt;,
#   Petal.Length_q50 &lt;dbl&gt;, Petal.Width_q50 &lt;dbl&gt;, Sepal.Length_q75 &lt;dbl&gt;,
#   Sepal.Width_q75 &lt;dbl&gt;, Petal.Length_q75 &lt;dbl&gt;, Petal.Width_q75 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>En mode programmation classique de R, on pourra générer les quartiles à la pièce.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">[</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">'setosa'</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0%  25%  50%  75% 100% 
 4.3  4.8  5.0  5.2  5.8 </code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">[</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">'versicolor'</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0%  25%  50%  75% 100% 
 4.9  5.6  5.9  6.3  7.0 </code></pre>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">[</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">'virginica'</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   0%   25%   50%   75%  100% 
4.900 6.225 6.500 6.900 7.900 </code></pre>
</div>
</div>
<p>La fonction <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> permettra d’obtenir des décomptes par catégorie, ici par plages de longueurs de sépales. Pour obtenir les proportions du nombre total, il s’agit d’encapsuler le tableau croisé dans la fonction <code><a href="https://rdrr.io/r/base/proportions.html">prop.table()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tableau_croise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tableau_croise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            
             (4.3,5.1] (5.1,5.8] (5.8,6.4] (6.4,7.9]
  setosa            35        14         0         0
  versicolor         4        20        17         9
  virginica          1         5        18        26</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="va">tableau_croise</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            
               (4.3,5.1]   (5.1,5.8]   (5.8,6.4]   (6.4,7.9]
  setosa     0.234899329 0.093959732 0.000000000 0.000000000
  versicolor 0.026845638 0.134228188 0.114093960 0.060402685
  virginica  0.006711409 0.033557047 0.120805369 0.174496644</code></pre>
</div>
</div>
</section><section id="tests-dhypothèses-à-un-et-deux-échantillons" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="tests-dhypothèses-à-un-et-deux-échantillons">
<span class="header-section-number">7.6</span> Tests d’hypothèses à un et deux échantillons</h2>
<p>Un test d’hypothèse permet de décider si une hypothèse est confirmée ou rejetée à un seuil de probabilité prédéterminé.</p>
<p>Cette section est inspirée du chapitre 5 de <a href="https://www.springer.com/us/book/9780387790534">Dalgaard, 2008</a>.</p>
<hr>
<p><strong>Information: l’hypothèse nulle</strong>. Les tests d’hypothèse évaluent des <em>effets</em> statistiques (qui ne sont pas nécessairement des effets de causalité). L’effet à évaluer peut être celui d’un traitement, d’indicateurs météorologiques (e.g.&nbsp;précipitations totales, degré-jour, etc.), de techniques de gestion des paysages, etc. Une recherche est menée pour évaluer l’hypothèse que l’on retrouve des différences entre des unités expérimentales. Par convention, l’<strong>hypothèse nulle</strong> (écrite <span class="math inline">\(H_0\)</span>) est l’hypothèse qu’il n’y ait pas d’effet (c’est l’hypothèse de l’avocat du diable 😈) à l’échelle de la population (et non pas à l’échelle de l’échantillon). À l’inverse, l’<strong>hypothèse alternative</strong> (écrite <span class="math inline">\(H_1\)</span>) est l’hypothèse qu’il y ait un effet à l’échelle de la population.</p>
<hr>
<p>À titre d’exercice en stats, on débute souvent en testant si deux vecteurs de valeurs continues proviennent de populations à moyennes différentes ou si un vecteur de valeurs a été généré à partir d’une population ayant une moyenne donnée. Dans cette section, nous utiliserons la fonction <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> pour les tests de t et la fonction <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> pour les tests de Wilcoxon (aussi appelé de Mann-Whitney).</p>
<section id="test-de-t-à-un-seul-échantillon" class="level3" data-number="7.6.1"><h3 data-number="7.6.1" class="anchored" data-anchor-id="test-de-t-à-un-seul-échantillon">
<span class="header-section-number">7.6.1</span> Test de t à un seul échantillon</h3>
<p>Nous devons assumer, pour ce test, que l’échantillon est recueillit d’une population dont la distribution est normale, <span class="math inline">\(\mathcal{N} \sim \left( \mu, \sigma^2 \right)\)</span>, et que chaque échantillon est indépendant l’un de l’autre. L’hypothèse nulle est souvent celle de l’avocat du diable, que la moyenne soit égale à une valeur donnée (donc la différence entre la moyenne de la population et une moyenne donnée est de zéro): ici, que <span class="math inline">\(\mu = \bar{x}\)</span>. L’erreur standard sur la moyenne (ESM) de l’échantillon, <span class="math inline">\(\bar{x}\)</span> est calculée comme suit.</p>
<p><span class="math display">\[ESM = \frac{s}{\sqrt{n}}\]</span></p>
<p>où <span class="math inline">\(s\)</span> est l’écart-type de l’échantillon et <span class="math inline">\(n\)</span> est le nombre d’échantillons.</p>
<p>Pour tester l’intervalle de confiance de l’échantillon, on multiplie l’ESM par l’aire sous la courbe de densité couvrant une certaine proportion de part et d’autre de l’échantillon. Pour un niveau de confiance de 95%, on retranche 2.5% de part et d’autre.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">33746</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">16</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">level</span> <span class="op">&lt;-</span>  <span class="fl">0.95</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="va">level</span></span>
<span></span>
<span><span class="va">x_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">s</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">error</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.483253</code></pre>
</div>
</div>
<p>L’intervalle de confiance est l’erreur de part et d’autre de la moyenne.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x_bar</span> <span class="op">-</span> <span class="va">error</span>, <span class="va">x_bar</span> <span class="op">+</span> <span class="va">error</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.35630 17.32281</code></pre>
</div>
</div>
<p>Si la moyenne de la population est de 16, un nombre qui se situe dans l’intervalle de confiance on accepte l’hypothèse nulle au seuil 0.05. Si le nombre d’échantillon est réduit (généralement &lt; 30), on passera plutôt par une distribution de t, avec <span class="math inline">\(n-1\)</span> degrés de liberté.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, <span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">s</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x_bar</span> <span class="op">-</span> <span class="va">error</span>, <span class="va">x_bar</span> <span class="op">+</span> <span class="va">error</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.25561 17.42351</code></pre>
</div>
</div>
<p>Plus simplement, on pourra utiliser la fonction <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> en spécifiant la moyenne de la population. Nous avons généré 20 données avec une moyenne de 16 et un écart-type de 4. Nous savons donc que la vraie moyenne de l’échantillon est de 16. Mais disons que nous testons l’hypothèse que ces données sont tirées d’une population dont la moyenne est 18 (et implicitement que son écart-type est de 4).</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">x</span>, mu <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  x
t = -2.8548, df = 19, p-value = 0.01014
alternative hypothesis: true mean is not equal to 18
95 percent confidence interval:
 14.25561 17.42351
sample estimates:
mean of x 
 15.83956 </code></pre>
</div>
</div>
<p>La fonction retourne la valeur de t (<em>t-value</em>), le nombre de degrés de liberté (<span class="math inline">\(n-1 = 19\)</span>), une description de l’hypothèse alternative (<code>alternative hypothesis: true mean is not equal to 18</code>), ainsi que l’intervalle de confiance au niveau de 95%. Le test contient aussi la <em>p-value</em>.</p>
<hr>
<section id="information-la-p-value" class="level4" data-number="7.6.1.1"><h4 data-number="7.6.1.1" class="anchored" data-anchor-id="information-la-p-value">
<span class="header-section-number">7.6.1.1</span> Information: la <em>p-value</em>
</h4>
<p>La <em>p-value</em>, ou valeur-p ou p-valeur, est utilisée pour trancher si, oui ou non, un résultat est <strong>significatif</strong>. En langage scientifique, le mot significatif ne devrait être utilisé <em>que</em> lorsque l’on réfère à un test d’hypothèse statistique. Vous retrouverez des <em>p-values</em> partout en stats. Les <em>p-values</em> indiquent la probabilité que les données ait été échantillonnées d’une population où un effet est observable selon le modèle statistique utilisé.</p>
<blockquote class="blockquote">
<p>La p-value est la probabilité que les données aient été générées pour obtenir un effet équivalent ou plus prononcé si l’hypothèse nulle est vraie.</p>
</blockquote>
<p>Une <em>p-value</em> élevée indique que le modèle appliqué à vos données concorde avec la conclusion que l’hypothèse nulle est vraie, et inversement si la <em>p-value</em> est faible. Le seuil arbitraire utilisée en écologie et en agriculture, comme dans plusieurs domaines, est de 0.05. L’utilisation d’un seuil est toutefois contestée <strong>avec raison</strong>. Une enquête menée dans la littérature scientifiques a révélé que 49% des 791 articles étudiés interprétaient un effet non significatif comme un effet nul (<a href="https://www.nature.com/articles/d41586-019-00857-9">Amrhein et al., 2019</a>). En effet, une catégorisation de la <em>p-value</em> avec un seuil de significativité brouille le jugement sur l’importance des effets et de leur incertitude. Les six principes de l’<a href="https://phys.org/news/2016-03-american-statistical-association-statement-significance.html">American Statistical Association</a> guident l’interprétation des <em>p-values</em>. [ma traduction]</p>
<ol type="1">
<li>Les <em>p-values</em> indiquent l’ampleur de l’incompatibilité des données avec le modèle statistique</li>
<li>Les <em>p-values</em> ne mesurent pas la probabilité que l’hypothèse étudiée soit vraie, ni la probabilité que les données ont été générées uniquement par la chance.</li>
<li>Les conclusions scientifiques et décisions d’affaire ou politiques ne devraient pas être basées sur l’atteinte d’une <em>p-value</em> à un seuil spécifique.</li>
<li>Une inférence appropriée demande un rapport complet et transparent.</li>
<li>Une <em>p-value</em>, ou une signification statistique, ne mesure pas l’ampleur d’un effet ou l’importance d’un résultat.</li>
<li>En tant que tel, une <em>p-value</em> n’offre pas une bonne mesure des évidences d’un modèle ou d’une hypothèse.</li>
</ol>
<hr>
<p>Dans le cas précédent, la <em>p-value</em> était de 0.01014. Pour aider notre interprétation, prenons l’hypothèse alternative: <code>true mean is not equal to 18</code>. L’hypothèse nulle était bien que <em>la vraie moyenne est égale à 18</em>. Insérons la <em>p-value</em> dans la définition: la probabilité que les données aient été générées pour obtenir un effet équivalent ou plus prononcé si l’hypothèse nulle est vraie est de 0.01014. Il est donc très peu probable que les données soient tirées d’un échantillon dont la moyenne est de 18. Au seuil de signification de 0.05, on rejette l’hypothèse nulle et l’on conclut qu’à ce seuil de confiance, l’échantillon ne provient pas d’une population ayant une moyenne de 18.</p>
</section></section><section id="attention-mauvaises-interprétations-des-p-values" class="level3" data-number="7.6.2"><h3 data-number="7.6.2" class="anchored" data-anchor-id="attention-mauvaises-interprétations-des-p-values">
<span class="header-section-number">7.6.2</span> Attention: mauvaises interprétations des <em>p-values</em>
</h3>
<blockquote class="blockquote">
<p>“La p-value n’a jamais été conçue comme substitut au raisonnement scientifique” <a href="https://phys.org/news/2016-03-american-statistical-association-statement-significance.html">Ron Wasserstein, directeur de l’American Statistical Association</a> [ma traduction].</p>
</blockquote>
<p><strong>Un résultat montrant une p-value plus élevée que 0.05 est-il pertinent?</strong></p>
<p>Lors d’une conférence, Dr Evil ne présente que les résultats significatifs de ses essais au seuil de 0.05. Certains essais ne sont pas significatifs, mais bon, ceux-ci ne sont pas importants… En écartant ces résultats, Dr Evil commet 3 erreurs:</p>
<ol type="1">
<li>La <em>p-value</em> n’est pas un bon indicateur de l’importance d’un test statistique. L’importance d’une variable dans un modèle devrait être évaluée par la valeur de son coefficient. Son incertitude devrait être évaluée par sa variance. Une manière plus intuitive d’évaluer la variance est l’écart-type ou l’intervalle de confiance. À un certain seuil d’intervalle de confiance, la <em>p-value</em> traduira la probabilité qu’un coefficient réellement nul ait pu générer des données démontrant un coefficient égal ou supérieur.</li>
<li>Il est tout aussi important de savoir que le traitement fonctionne que de savoir qu’il ne fonctionne pas. Les résultats démontrant des effets sont malheureusement davantage soumis aux journaux et davantage publiés que ceux ne démontrant pas d’effets (<a href="https://doi.org/10.1136/bmj.38488.385995.8F">Decullier et al., 2005</a>).</li>
<li>Le seuil de 0.05 est arbitraire.</li>
</ol>
<hr>
<section id="attention-au-p-hacking" class="level4" data-number="7.6.2.1"><h4 data-number="7.6.2.1" class="anchored" data-anchor-id="attention-au-p-hacking">
<span class="header-section-number">7.6.2.1</span> Attention au <em>p-hacking</em>
</h4>
<p>Le <em>p-hacking</em> (ou <em>data dredging</em>) consiste à manipuler les données et les modèles pour faire en sorte d’obtenir des <em>p-values</em> favorables à l’hypothèse testée et, éventuellement, aux conclusions recherchées. <strong>À éviter dans tous les cas. Toujours. Toujours. Toujours.</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/07_p-hacking.png" class="img-fluid figure-img" width="456"></p>
<figcaption class="figure-caption">Un sketch humoristique de John Oliver sur le <em>p-hacking</em>, <a href="https://youtu.be/0Rnq1NpHdmw">Last week tonight, 2016</a> (en anglais)</figcaption></figure>
</div>
</div>
</div>
<hr></section></section><section id="test-de-wilcoxon-à-un-seul-échantillon" class="level3" data-number="7.6.3"><h3 data-number="7.6.3" class="anchored" data-anchor-id="test-de-wilcoxon-à-un-seul-échantillon">
<span class="header-section-number">7.6.3</span> Test de Wilcoxon à un seul échantillon</h3>
<p>Le test de t suppose que la distribution des données est normale… ce qui est rarement le cas, surtout lorsque les échantillons sont peu nombreux. Le test de Wilcoxon ne demande aucune supposition sur la distribution: c’est un test non-paramétrique basé sur le tri des valeurs.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">x</span>, mu <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank exact test

data:  x
V = 39, p-value = 0.01208
alternative hypothesis: true location is not equal to 18</code></pre>
</div>
</div>
<p>Le <code>V</code> est la somme des rangs positifs. Dans ce cas, la <em>p-value</em> est semblable à celle du test de t, et les mêmes conclusions s’appliquent.</p>
</section><section id="tests-de-t-à-deux-échantillons" class="level3" data-number="7.6.4"><h3 data-number="7.6.4" class="anchored" data-anchor-id="tests-de-t-à-deux-échantillons">
<span class="header-section-number">7.6.4</span> Tests de t à deux échantillons</h3>
<p>Les tests à un échantillon servent plutôt à s’exercer: rarement en aura-t-on besoin en recherche, où plus souvent, on voudra comparer les moyennes de deux unités expérimentales. L’expérience comprend donc deux séries de données continues, <span class="math inline">\(x_1\)</span> et <span class="math inline">\(x_2\)</span>, issues de lois de distribution normale <span class="math inline">\(\mathcal{N} \left( \mu_1, \sigma_1^2 \right)\)</span> et <span class="math inline">\(\mathcal{N} \left( \mu_2, \sigma_2^2 \right)\)</span>, et nous testons l’hypothèse nulle que <span class="math inline">\(\mu_1 = \mu_2\)</span>. La statistique t est calculée comme suit.</p>
<p><span class="math display">\[t = \frac{\bar{x_1} - \bar{x_2}}{ESDM}\]</span></p>
<p>L’ESDM est l’erreur standard de la différence des moyennes:</p>
<p><span class="math display">\[ESDM = \sqrt{ESM_1^2 + ESM_2^2}\]</span></p>
<p>Si vous supposez que les variances sont identiques, l’erreur standard (<span class="math inline">\(s\)</span>) est calculée pour les échantillons des deux groupes, puis insérée dans le calcul des ESM. La statistique t sera alors évaluée à <span class="math inline">\(n_1 + n_2 - 2\)</span> degrés de liberté. Si vous supposez que la variance est différente (<em>procédure de Welch</em>), vous calculez les ESM avec les erreurs standards respectives, et la statistique t devient une approximation de la distribution de t avec un nombre de degrés de liberté calculé à partir des erreurs standards et du nombre d’échantillon dans les groupes: cette procédure est considérée comme plus prudente (<a href="https://www.springer.com/us/book/9780387790534">Dalgaard, 2008</a>, page 101).</p>
<p>Prenons les données d’iris pour l’exemple en excluant l’iris setosa étant donnée que les tests de t se restreignent à deux groupes. Nous allons tester la longueur des pétales.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris_pl</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">!=</span> <span class="st">"setosa"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Species</span>, <span class="va">Petal.Length</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span><span class="va">iris_pl</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Species Petal.Length
1  virginica          5.1
2 versicolor          4.0
3  virginica          5.0
4 versicolor          4.6
5 versicolor          4.1</code></pre>
</div>
</div>
<p>Dans la prochaine cellule de code, nous introduisons l’<em>interface-formule</em> de R, où l’on retrouve typiquement le <code>~</code>, entre les variables de sortie à gauche et les variables d’entrée à droite. Dans notre cas, la variable de sortie est la variable testée, <code>Petal.Length</code>, qui varie en fonction du groupe <code>Species</code>, qui est la variable d’entrée (variable explicative) - nous verrons les types de variables plus en détails dans la section sur les modèles statistiques (<a href="#sec-bios-models">chapitre&nbsp;<span>7.8</span></a>).</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span>
<span>       data <span class="op">=</span> <span class="va">iris_pl</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Petal.Length by Species
t = -12.604, df = 95.57, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group versicolor and group virginica is not equal to 0
95 percent confidence interval:
 -1.49549 -1.08851
sample estimates:
mean in group versicolor  mean in group virginica 
                   4.260                    5.552 </code></pre>
</div>
</div>
<p>Nous obtenons une sortie similaire aux précédentes. L’intervalle de confiance à 95% exclut le zéro, ce qui est cohérent avec la <em>p-value</em> très faible, qui nous indique le rejet de l’hypothèse nulle au seuil 0.05. Les données montrent que les groupes ont des moyennes de longueur de pétales différentes.</p>
<hr>
<section id="enregistrer-les-résultats-dun-test" class="level4" data-number="7.6.4.1"><h4 data-number="7.6.4.1" class="anchored" data-anchor-id="enregistrer-les-résultats-dun-test">
<span class="header-section-number">7.6.4.1</span> Enregistrer les résultats d’un test</h4>
<p>Il est possible d’enregistrer un test dans un objet.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tt_pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span>
<span>                data <span class="op">=</span> <span class="va">iris_pl</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">tt_pl</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Length Class  Mode     
statistic   1      -none- numeric  
parameter   1      -none- numeric  
p.value     1      -none- numeric  
conf.int    2      -none- numeric  
estimate    2      -none- numeric  
null.value  1      -none- numeric  
stderr      1      -none- numeric  
alternative 1      -none- character
method      1      -none- character
data.name   1      -none- character</code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">tt_pl</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 10
 $ statistic  : Named num -12.6
  ..- attr(*, "names")= chr "t"
 $ parameter  : Named num 95.6
  ..- attr(*, "names")= chr "df"
 $ p.value    : num 4.9e-22
 $ conf.int   : num [1:2] -1.5 -1.09
  ..- attr(*, "conf.level")= num 0.95
 $ estimate   : Named num [1:2] 4.26 5.55
  ..- attr(*, "names")= chr [1:2] "mean in group versicolor" "mean in group virginica"
 $ null.value : Named num 0
  ..- attr(*, "names")= chr "difference in means between group versicolor and group virginica"
 $ stderr     : num 0.103
 $ alternative: chr "two.sided"
 $ method     : chr "Welch Two Sample t-test"
 $ data.name  : chr "Petal.Length by Species"
 - attr(*, "class")= chr "htest"</code></pre>
</div>
</div>
<hr></section></section><section id="comparaison-des-variances" class="level3" data-number="7.6.5"><h3 data-number="7.6.5" class="anchored" data-anchor-id="comparaison-des-variances">
<span class="header-section-number">7.6.5</span> Comparaison des variances</h3>
<p>Pour comparer les variances, on a recours au test de F (F pour Fisher).</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span>
<span>         data <span class="op">=</span> <span class="va">iris_pl</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  Petal.Length by Species
F = 0.72497, num df = 49, denom df = 49, p-value = 0.2637
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.411402 1.277530
sample estimates:
ratio of variances 
         0.7249678 </code></pre>
</div>
</div>
<p>Il semble que l’on pourrait relancer le test de <em>t</em> sans la procédure Welch, avec <code>var.equal = TRUE</code>.</p>
</section><section id="tests-de-wilcoxon-à-deux-échantillons" class="level3" data-number="7.6.6"><h3 data-number="7.6.6" class="anchored" data-anchor-id="tests-de-wilcoxon-à-deux-échantillons">
<span class="header-section-number">7.6.6</span> Tests de Wilcoxon à deux échantillons</h3>
<p>Cela ressemble au test de t!</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span>
<span>       data <span class="op">=</span> <span class="va">iris_pl</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  Petal.Length by Species
W = 44.5, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</section><section id="les-tests-pairés" class="level3" data-number="7.6.7"><h3 data-number="7.6.7" class="anchored" data-anchor-id="les-tests-pairés">
<span class="header-section-number">7.6.7</span> Les tests pairés</h3>
<p>Les tests pairés sont utilisés lorsque deux échantillons proviennent d’une même unité expérimentale: il s’agit en fait de tests sur la différence entre deux observations.</p>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2555</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">avant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">16</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">apres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">18</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il est important de spécifier que le test est pairé, la valeur par défaut de <code>paired</code> étant <code>FALSE</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">avant</span>, <span class="va">apres</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  avant and apres
t = -1.5168, df = 19, p-value = 0.1458
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -4.5804586  0.7311427
sample estimates:
mean difference 
      -1.924658 </code></pre>
</div>
</div>
<p>L’hypothèse nulle qu’il n’y ait pas de différence entre l’avant et l’après traitement est acceptée au seuil 0.05.</p>
<p><strong>Exercice</strong>. Effectuer un test de Wilcoxon pairé.</p>
</section></section><section id="lanalyse-de-variance" class="level2" data-number="7.7"><h2 data-number="7.7" class="anchored" data-anchor-id="lanalyse-de-variance">
<span class="header-section-number">7.7</span> L’analyse de variance</h2>
<p>L’analyse de variance consiste à comparer des moyennes de plusieurs groupes distribués normalement et de même variance. Cette section sera élaborée prochainement plus en profondeur. Considérons-la pour le moment comme une régression sur une variable catégorielle.</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pl_aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Species</span>, <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pl_aov</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
Species       2  437.1  218.55    1180 &lt;2e-16 ***
Residuals   147   27.2    0.19                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>La prochaine section, justement, est vouée aux modèles statistiques explicatifs, qui incluent la régression.</p>
</section><section id="sec-bios-models" class="level2" data-number="7.8"><h2 data-number="7.8" class="anchored" data-anchor-id="sec-bios-models">
<span class="header-section-number">7.8</span> Les modèles statistiques</h2>
<p>La modélisation statistique consiste à lier de manière explicite des variables de sortie <span class="math inline">\(y\)</span> (ou variables-réponse / variables dépendantes) à des variables explicatives <span class="math inline">\(x\)</span> (ou variables prédictives / indépendantes / covariables). Les variables-réponse sont modélisées par une fonction des variables explicatives ou prédictives.</p>
<p>Pourquoi garder les termes <em>explicatives</em> et <em>prédictives</em>? Parce que les modèles statistiques (basés sur des données et non pas sur des mécanismes) sont de deux ordres. D’abord, les modèles <strong>prédictifs</strong> sont conçus pour prédire de manière fiable une ou plusieurs variables-réponse à partir des informations contenues dans les variables qui sont, dans ce cas, prédictives (par exemple : Les séries temporelles au <a href="11-series-temporelles.html">chapitre&nbsp;<span>12</span></a>). Lorsque l’on désire tester des hypothèses pour évaluer quelles variables expliquent la réponse, on parlera de modélisation (et de variables) <strong>explicative</strong>. En inférence statistique, on évaluera les <em>corrélations</em> entre les variables explicatives et les variables-réponse. Un lien de corrélation n’est pas un lien de causalité. L’inférence causale peut en revanche être évaluée par des <a href="https://doi.org/10.1017/CBO9781139979573"><em>modèles d’équations structurelles</em></a>.</p>
<p>Cette section couvre la modélisation explicative. Les variables qui contribuent à créer les modèles peuvent être de différentes natures et distribuées selon différentes lois de probabilité. Alors que les modèles linéaires simples (<em>lm</em>) impliquent une variable-réponse distribuée de manière continue, les modèles linéaires généralisés peuvent aussi expliquer des variables de sorties discrètes.</p>
<p>Dans les deux cas, on distinguera les variables fixes et les variables aléatoires. Les <strong>variables fixes</strong> sont les variables testées lors de l’expérience: dose du traitement, espèce/cultivar, météo, etc. Les <strong>variables aléatoires</strong> sont les sources de variation qui génèrent du bruit dans le modèle: les unités expérimentales ou le temps lors de mesures répétées. Les modèles incluant des effets fixes seulement sont des modèles à effets fixes. Généralement, les modèles incluant des variables aléatoires incluent aussi des variables fixes: on parlera alors de modèles mixtes. Nous couvrirons ces deux types de modèles.</p>
<section id="modèles-à-effets-fixes" class="level3" data-number="7.8.1"><h3 data-number="7.8.1" class="anchored" data-anchor-id="modèles-à-effets-fixes">
<span class="header-section-number">7.8.1</span> Modèles à effets fixes</h3>
<p>Les tests de t et de Wilcoxon, explorés précédemment, sont des modèles statistiques à une seule variable. Nous avons vu dans l’<em>interface-formule</em> qu’une variable-réponse peut être liée à une variable explicative avec le tilde <code>~</code>. En particulier, le test de t est une régression linéaire univariée (à une seule variable explicative) dont la variable explicative comprend deux catégories. De même, l’anova est une régression linéaire univariée dont la variable explicative comprend plusieurs catégories. Or l’interface-formule peut être utilisé dans plusieurs circonstances, notamment pour ajouter plusieurs variables de différents types: on parlera de régression multivariée.</p>
<p>La plupart des modèles statistiques peuvent être approximés comme une combinaison linéaire de variables: ce sont des modèles linéaires. Les modèles non-linéaires impliquent des stratégies computationnelles complexes qui rendent leur utilisation plus difficile à manœuvrer.</p>
<p>Un modèle linéaire univarié prendra la forme <span class="math inline">\(y = \beta_0 + \beta_1 x + \epsilon\)</span>, où <span class="math inline">\(\beta_0\)</span> est l’intercept et <span class="math inline">\(\beta_1\)</span> est la pente et <span class="math inline">\(\epsilon\)</span> est l’erreur.</p>
<p>Vous verrez parfois la notation <span class="math inline">\(\hat{y} = \beta_0 + \beta_1 x\)</span>. La notation avec le chapeau <span class="math inline">\(\hat{y}\)</span> exprime qu’il s’agit des valeurs générées par le modèle. En fait, <span class="math inline">\(y = \hat{y} - \epsilon\)</span>.</p>
<section id="modèle-linéaire-univarié-avec-variable-continue" class="level4" data-number="7.8.1.1"><h4 data-number="7.8.1.1" class="anchored" data-anchor-id="modèle-linéaire-univarié-avec-variable-continue">
<span class="header-section-number">7.8.1.1</span> Modèle linéaire univarié avec variable continue</h4>
<p>Prenons les données <a href="https://rdrr.io/cran/agridat/man/lasrosas.corn.html"><code>lasrosas.corn</code></a> incluses dans le module <code>agridat</code>, où l’on retrouve le rendement d’une production de maïs à dose d’azote variable, en Argentine.</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://kwstat.github.io/agridat/">"agridat"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"lasrosas.corn"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span><span class="va">lasrosas.corn</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year       lat      long yield nitro topo     bv rep nf
1  1999 -33.05207 -63.84230 69.57   0.0   LO 185.67  R1 N0
2  1999 -33.05137 -63.84383 67.41  53.0    E 175.12  R2 N2
3  1999 -33.05104 -63.84323 68.33  29.0   LO 168.70  R3 N1
4  1999 -33.05162 -63.84456 68.06  53.0    E 171.71  R1 N2
5  1999 -33.05180 -63.84386 63.99   0.0   LO 172.46  R1 N0
6  2001 -33.05065 -63.84578 35.85  50.6   HT 194.85  R1 N2
7  1999 -33.05170 -63.84553 58.89 131.5   HT 187.98  R1 N5
8  2001 -33.05077 -63.84502 50.95 124.6   HT 184.66  R2 N5
9  1999 -33.05181 -63.84202 78.75 106.0   LO 169.25  R2 N4
10 1999 -33.05154 -63.84468 68.58  29.0    E 169.35  R1 N1</code></pre>
</div>
</div>
<p>Ces données comprennent plusieurs variables. Prenons le rendement (<code>yield</code>) comme variable de sortie et, pour le moment, ne retenons que la dose d’azote (<code>nitro</code>) comme variable explicative: il s’agit d’une régression univariée. Les deux variables sont continues. Explorons d’abord le nuage de points de l’une et l’autre.</p>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lasrosas.corn</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nitro</span>, y <span class="op">=</span> <span class="va">yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-plot-nitro-agridat-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>L’hypothèse nulle est que la dose d’azote n’affecte pas le rendement, c’est à dire que le coefficient de pente et nul. Une autre hypothèse est que l’intercept est nul, c’est à dire qu’à une dose de 0, le rendement est de 0. Un modèle linéaire à variable de sortie continue est créé avec la fonction <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, pour <em>linear model</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modlin_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">nitro</span>, data <span class="op">=</span> <span class="va">lasrosas.corn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modlin_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ nitro, data = lasrosas.corn)

Residuals:
    Min      1Q  Median      3Q     Max 
-53.183 -15.341  -3.079  13.725  45.897 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 65.843213   0.608573 108.193  &lt; 2e-16 ***
nitro        0.061717   0.007868   7.845 5.75e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.66 on 3441 degrees of freedom
Multiple R-squared:  0.01757,   Adjusted R-squared:  0.01728 
F-statistic: 61.54 on 1 and 3441 DF,  p-value: 5.754e-15</code></pre>
</div>
</div>
<p>Le diagnostic du modèle comprend plusieurs informations. D’abord, la formule utilisée est affichée pour la traçabilité. Vient ensuite un aperçu de la distribution des résidus. La médiane devrait s’approcher de la moyenne des résidus (qui est toujours de 0). Bien que le -3.079 peut sembler important, il faut prendre en considération l’échelle de y, et ce -3.079 est exprimé en terme de rendement, ici en quintaux (i.e.&nbsp;100 kg) par hectare. La distribution des résidus mérite d’être davantage investiguée. Nous verrons cela un peu plus tard.</p>
<p>Les coefficients apparaissent ensuite. Les estimés sont les valeurs des effets. R fournit aussi l’erreur standard associée, la valeur de t ainsi que la p-value (la probabilité d’obtenir cet effet ou un effet plus extrême si en réalité il y avait absence d’effet). L’intercept est bien sûr plus élevé que 0 (à dose nulle, on obtient un rendement de 65.8 quintaux par hectare en moyenne). La pente de la variable <code>nitro</code> est de ~0.06: pour chaque augmentation d’un kg/ha de dose, on a obtenu ~0.06 quintaux/ha de plus de maïs. Donc pour 100 kg/ha de N, on a obtenu un rendement moyen de 6 quintaux de plus que l’intercept. Soulignons que l’ampleur du coefficient est très important pour guider la fertilisation: ne rapporter que la <em>p-value</em>, ou ne rapporter que le fait qu’elle est inférieure à 0.05 (ce qui arrive souvent dans la littérature), serait très insuffisant pour l’interprétation des statistiques. La <em>p-value</em> nous indique néanmoins qu’il serait très improbable qu’une telle pente ait été générée alors que celle-ci est nulle en réalité. Les étoiles à côté des p-values indiquent l’ampleur selon l’échelle <code>Signif. codes</code> indiquée en-dessous du tableau des coefficients.</p>
<p>Sous ce tableau, R offre d’autres statistiques. En outre, les R² et R² ajustés indiquent si la régression passe effectivement par les points. Le R² prend un maximum de 1 lorsque la droite passe exactement sur les points.</p>
<p>Enfin, le test de F génère une <em>p-value</em> indiquant la probabilité que les coefficients de pente ait été générés si les vrais coefficients étaient nuls. Dans le cas d’une régression univariée, cela répète l’information sur l’unique coefficient.</p>
<p>On pourra également obtenir les intervalles de confiance avec la fonction <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">modlin_1</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %      97.5 %
(Intercept) 64.65001137 67.03641474
nitro        0.04629164  0.07714271</code></pre>
</div>
</div>
<p>Ou soutirer l’information de différentes manières, comme avec la fonction <code><a href="https://rdrr.io/r/stats/coef.html">coefficients()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">modlin_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       nitro 
65.84321305  0.06171718 </code></pre>
</div>
</div>
<p>Également, on pourra exécuter le modèle sur les données qui ont servi à le générer:</p>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">modlin_1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5 
73.95902 73.95902 73.95902 73.95902 73.95902 </code></pre>
</div>
</div>
<p>Ou sur des données externes.</p>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nouvelles_donnees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>nitro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">modlin_1</span>, newdata <span class="op">=</span> <span class="va">nouvelles_donnees</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5 
65.84321 66.15180 66.46038 66.76897 67.07756 </code></pre>
</div>
</div>
</section><section id="analyse-des-résidus" class="level4" data-number="7.8.1.2"><h4 data-number="7.8.1.2" class="anchored" data-anchor-id="analyse-des-résidus">
<span class="header-section-number">7.8.1.2</span> Analyse des résidus</h4>
<p>Les résidus sont les erreurs du modèle. C’est le vecteur <span class="math inline">\(\epsilon\)</span>, qui est un décalage entre les données et le modèle. Le R² est un indicateur de l’ampleur du décalage, mais une régression linéaire explicative en bonne et due forme devrait être accompagnée d’une analyse des résidus. On peut les calculer par <span class="math inline">\(\epsilon = y - \hat{y}\)</span>, ou alors simplement utiliser la fonction <code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>nitro <span class="op">=</span> <span class="va">lasrosas.corn</span><span class="op">$</span><span class="va">nitro</span>,</span>
<span>                     residus_lm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">modlin_1</span><span class="op">)</span>,</span>
<span>                     residus_calcul <span class="op">=</span> <span class="va">lasrosas.corn</span><span class="op">$</span><span class="va">yield</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">modlin_1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span><span class="va">res_df</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     nitro residus_lm residus_calcul
2931 124.6  24.666827      24.666827
1793 124.6  11.126827      11.126827
2006  99.8  25.417413      25.417413
116   66.0 -11.636547     -11.636547
1235 131.5  11.460978      11.460978
2426  75.4 -18.686688     -18.686688
1132  29.0  -1.763011      -1.763011
15   131.5 -11.289022     -11.289022
1691 131.5  -5.639022      -5.639022
38   131.5 -13.129022     -13.129022</code></pre>
</div>
</div>
<p>Dans une bonne régression linéaire, on ne retrouvera pas de structure identifiable dans les résidus, c’est-à-dire que les résidus sont bien distribués de part et d’autre du modèle de régression.</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">res_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nitro</span>, y <span class="op">=</span> <span class="va">residus_lm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Dose N"</span>, y <span class="op">=</span> <span class="st">"Résidus"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-lm1-residuals-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Bien que le jugement soit subjectif, on peut dire avec confiance qu’il n’y a pas structure particulière. En revanche, on pourrait générer un <span class="math inline">\(y\)</span> qui varie de manière quadratique avec <span class="math inline">\(x\)</span>, un modèle linéaire montrera une structure évidente.</p>
<div class="cell">
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">36164</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="va">x</span><span class="op">*</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">0.05</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">modlin_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">y</span>, residus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">modlin_2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">residus</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"Résidus"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-residuals-example-banana-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Également, les résidus ne devraient pas croître avec <span class="math inline">\(x\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">3984</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span>  <span class="fl">10</span> <span class="op">+</span> <span class="va">x</span> <span class="op">+</span> <span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">modlin_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, residus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">modlin_3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">residus</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"Résidus"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-residuals-example-expand-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On pourra aussi inspecter les résidus avec un graphique de leur distribution. Reprenons notre modèle de rendement du maïs.</p>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">res_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">residus_lm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Residual"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-residuals-agridat-groups-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>L’histogramme devrait présenter une distribution normale. Les tests de normalité comme le test de Shapiro-Wilk peuvent aider, mais ils sont généralement très sévères.</p>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">res_df</span><span class="op">$</span><span class="va">residus_lm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  res_df$residus_lm
W = 0.94868, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>L’hypothèse nulle que la distribution est normale est rejetée au seuil 0.05. Dans notre cas, il est évident que la sévérité du test n’est pas en cause car les résidus semblent générer trois ensembles. Ceci indique que les variables explicatives sont insuffisantes pour expliquer la variabilité de la variable-réponse.</p>
</section><section id="régression-multiple" class="level4" data-number="7.8.1.3"><h4 data-number="7.8.1.3" class="anchored" data-anchor-id="régression-multiple">
<span class="header-section-number">7.8.1.3</span> Régression multiple</h4>
<p>Comme c’est le cas pour bien des phénomènes en écologie, le rendement d’une culture n’est certainement pas expliqué seulement par la dose d’azote.</p>
<p>Lorsque l’on combine plusieurs variables explicatives, on crée un modèle de régression multivariée, ou une régression multiple. Bien que les tendances puissent sembler non-linéaires, l’ajout de variables et le calcul des coefficients associés reste un problème d’algèbre linéaire.</p>
<p>On pourra en effet généraliser les modèles linéaires, univariés et multivariés, de la manière suivante.</p>
<p><span class="math display">\[ y = X \beta + \epsilon \]</span></p>
<p>où:</p>
<p><span class="math inline">\(X\)</span> est la matrice du modèle à <span class="math inline">\(n\)</span> observations et <span class="math inline">\(p\)</span> variables.</p>
<p><span class="math display">\[ X = \left( \begin{matrix}
1 &amp; x_{11} &amp; \cdots &amp; x_{1p}  \\
1 &amp; x_{21} &amp; \cdots &amp; x_{2p}  \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots  \\
1 &amp; x_{n1} &amp; \cdots &amp; x_{np}
\end{matrix} \right) \]</span></p>
<p><span class="math inline">\(\beta\)</span> est la matrice des <span class="math inline">\(p\)</span> coefficients, <span class="math inline">\(\beta_0\)</span> étant l’intercept qui multiplie la première colonne de la matrice <span class="math inline">\(X\)</span>.</p>
<p><span class="math display">\[ \beta = \left( \begin{matrix}
\beta_0  \\
\beta_1  \\
\vdots \\
\beta_p
\end{matrix} \right) \]</span></p>
<p><span class="math inline">\(\epsilon\)</span> est l’erreur de chaque observation.</p>
<p><span class="math display">\[ \epsilon = \left( \begin{matrix}
\epsilon_0  \\
\epsilon_1  \\
\vdots \\
\epsilon_n
\end{matrix} \right) \]</span></p>
</section><section id="modèles-linéaires-univariés-avec-variable-catégorielle-nominale" class="level4" data-number="7.8.1.4"><h4 data-number="7.8.1.4" class="anchored" data-anchor-id="modèles-linéaires-univariés-avec-variable-catégorielle-nominale">
<span class="header-section-number">7.8.1.4</span> Modèles linéaires univariés avec variable catégorielle <strong>nominale</strong>
</h4>
<p>Une variable catégorielle nominale (non ordonnée) utilisée à elle seule dans un modèle comme variable explicative, est un cas particulier de régression multiple. En effet, l’<strong>encodage catégoriel</strong> (ou <em>dummyfication</em>) transforme une variable catégorielle nominale en une matrice de modèle comprenant une colonne désignant l’intercept (une série de 1) désignant la catégorie de référence, ainsi que des colonnes pour chacune des autres catégories désignant l’appartenance (1) ou la non appartenance (0) de la catégorie désignée par la colonne.</p>
<section id="lencodage-catégoriel" class="level5" data-number="7.8.1.4.1"><h5 data-number="7.8.1.4.1" class="anchored" data-anchor-id="lencodage-catégoriel">
<span class="header-section-number">7.8.1.4.1</span> L’encodage catégoriel</h5>
<p>Une variable à <span class="math inline">\(C\)</span> catégories pourra être déclinée en <span class="math inline">\(C\)</span> variables dont chaque colonne désigne par un 1 l’appartenance au groupe de la colonne et par un 0 la non-appartenance. Pour l’exemple, créons un vecteur désignant le cultivar de pomme de terre.</p>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>cultivar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Superior'</span>, <span class="st">'Superior'</span>, <span class="st">'Superior'</span>, <span class="st">'Russet'</span>, <span class="st">'Kenebec'</span>, <span class="st">'Russet'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">cultivar</span>, <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) cultivarRusset cultivarSuperior
1           1              0                1
2           1              0                1
3           1              0                1
4           1              1                0
5           1              0                0
6           1              1                0
attr(,"assign")
[1] 0 1 1
attr(,"contrasts")
attr(,"contrasts")$cultivar
[1] "contr.treatment"</code></pre>
</div>
</div>
<p>Nous avons trois catégories, encodées en trois colonnes. La première colonne est un intercept et les deux autres décrivent l’absence (0) ou la présence (1) des cultivars Russet et Superior. Le cultivar Kenebec est absent du tableau. En effet, en partant du principe que l’appartenance à une catégorie est mutuellement exclusive, c’est-à-dire qu’un échantillon ne peut être assigné qu’à une seule catégorie, on peut déduire une catégorie à partir de l’information sur toutes les autres. Par exemple, si <code>cultivar_Russet</code> et <code>cultivar_Superior</code> sont toutes deux égales à <span class="math inline">\(0\)</span>, on conclura que <code>cultivar_Kenebec</code> est nécessairement égal à <span class="math inline">\(1\)</span>. Et si l’un d’entre <code>cultivar_Russet</code> et <code>cultivar_Superior</code> est égal à <span class="math inline">\(1\)</span>, <code>cultivar_Kenebec</code> est nécessairement égal à <span class="math inline">\(0\)</span>. L’information contenue dans un nombre <span class="math inline">\(C\)</span> de catégories peut être encodée dans un nombre <span class="math inline">\(C-1\)</span> de colonnes. C’est pourquoi, dans une analyse statistique, on désignera une catégorie comme une référence, que l’on détecte lorsque toutes les autres catégories sont encodées avec des <span class="math inline">\(0\)</span>: cette référence sera incluse dans l’intercept. La catégorie de référence par défaut en R est la première catégorie dans l’ordre alphabétique. On pourra modifier cette référence avec la fonction <code><a href="https://rdrr.io/r/stats/relevel.html">relevel()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span><span class="op">$</span><span class="va">cultivar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">cultivar</span>, ref <span class="op">=</span> <span class="st">"Superior"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">cultivar</span>, <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) cultivarKenebec cultivarRusset
1           1               0              0
2           1               0              0
3           1               0              0
4           1               0              1
5           1               1              0
6           1               0              1
attr(,"assign")
[1] 0 1 1
attr(,"contrasts")
attr(,"contrasts")$cultivar
[1] "contr.treatment"</code></pre>
</div>
</div>
<p>Pour certains modèles, vous devrez vous assurer vous-même de l’encodage catégoriel. Pour d’autre, en particulier avec l’<em>interface par formule</em> de R, ce sera fait automatiquement.</p>
</section><section id="exemple-dapplication" class="level5" data-number="7.8.1.4.2"><h5 data-number="7.8.1.4.2" class="anchored" data-anchor-id="exemple-dapplication">
<span class="header-section-number">7.8.1.4.2</span> Exemple d’application</h5>
<p>Prenons la topographie du terrain, qui peut prendre plusieurs niveaux.</p>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">lasrosas.corn</span><span class="op">$</span><span class="va">topo</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "E"  "HT" "LO" "W" </code></pre>
</div>
</div>
<p>Explorons le rendement selon la topographie.</p>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">lasrosas.corn</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">topo</span>, y <span class="op">=</span> <span class="va">yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-lasrosas-topo-boxplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Les différences sont évidentes, et la modélisation devrait montrer des effets différents.</p>
<p>L’encodage catégoriel peut être visualisé en générant la matrice de modèle avec la fonction <code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code> et l’interface-formule - sans la variable-réponse.</p>
<div class="cell">
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">topo</span>, data <span class="op">=</span> <span class="va">lasrosas.corn</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># as_tibble pour transformer la matrice en tableau</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   `(Intercept)` topoHT topoLO topoW
           &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1             1      0      0     0
 2             1      0      1     0
 3             1      0      0     1
 4             1      0      0     1
 5             1      0      1     0
 6             1      0      0     1
 7             1      1      0     0
 8             1      0      1     0
 9             1      0      0     1
10             1      0      0     0</code></pre>
</div>
</div>
<p>Dans le cas d’un modèle avec une variable catégorielle nominale seule, l’intercept représente la catégorie de référence, ici <code>E</code>. Les autres colonnes spécifient l’appartenance (1) ou la non-appartenance (0) de la catégorie pour chaque observation.</p>
<p>Cette matrice de modèle utilisée pour la régression donnera un intercept, qui indiquera l’effet de la catégorie de référence, puis les différences entre les catégories subséquentes et la catégorie de référence.</p>
<div class="cell">
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modlin_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">topo</span>, data <span class="op">=</span> <span class="va">lasrosas.corn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modlin_4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ topo, data = lasrosas.corn)

Residuals:
    Min      1Q  Median      3Q     Max 
-47.371 -11.933  -1.593  11.080  44.119 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  78.6653     0.5399 145.707   &lt;2e-16 ***
topoHT      -30.0526     0.7500 -40.069   &lt;2e-16 ***
topoLO        6.2832     0.7293   8.615   &lt;2e-16 ***
topoW       -11.8841     0.7039 -16.883   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.59 on 3439 degrees of freedom
Multiple R-squared:  0.4596,    Adjusted R-squared:  0.4591 
F-statistic:   975 on 3 and 3439 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Le modèle linéaire est équivalent à l’anova, mais les résultats de <code>lm</code> sont plus élaborés.</p>
<div class="cell">
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">topo</span>, data <span class="op">=</span> <span class="va">lasrosas.corn</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df Sum Sq Mean Sq F value Pr(&gt;F)    
topo           3 622351  207450     975 &lt;2e-16 ***
Residuals   3439 731746     213                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>L’analyse de résidus peut être effectuée de la même manière.</p>
</section></section><section id="modèles-linéaires-univariés-avec-variable-catégorielle-ordinale" class="level4" data-number="7.8.1.5"><h4 data-number="7.8.1.5" class="anchored" data-anchor-id="modèles-linéaires-univariés-avec-variable-catégorielle-ordinale">
<span class="header-section-number">7.8.1.5</span> Modèles linéaires univariés avec variable catégorielle <strong>ordinale</strong>
</h4>
<p>Bien que j’introduise la régression sur variable catégorielle ordinale à la suite de la section sur les variables nominales, nous revenons dans ce cas à une régression simple, univariée. Voyons un cas à 5 niveaux.</p>
<div class="cell">
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">statut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Totalement en désaccord"</span>,</span>
<span>            <span class="st">"En désaccord"</span>,</span>
<span>            <span class="st">"Ni en accord, ni en désaccord"</span>,</span>
<span>            <span class="st">"En accord"</span>,</span>
<span>            <span class="st">"Totalement en accord"</span><span class="op">)</span></span>
<span><span class="va">statut_o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">statut</span>, levels <span class="op">=</span> <span class="va">statut</span>, ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">statut_o</span><span class="op">)</span> <span class="co"># ou bien, sans passer par model.matrix, contr.poly(5) où 5 est le nombre de niveaux</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)    statut_o.L statut_o.Q    statut_o.C statut_o^4
1           1 -6.324555e-01  0.5345225 -3.162278e-01  0.1195229
2           1 -3.162278e-01 -0.2672612  6.324555e-01 -0.4780914
3           1 -3.510833e-17 -0.5345225  1.755417e-16  0.7171372
4           1  3.162278e-01 -0.2672612 -6.324555e-01 -0.4780914
5           1  6.324555e-01  0.5345225  3.162278e-01  0.1195229
attr(,"assign")
[1] 0 1 1 1 1
attr(,"contrasts")
attr(,"contrasts")$statut_o
[1] "contr.poly"</code></pre>
</div>
</div>
<p>La matrice de modèle a 5 colonnes, soit le nombre de niveaux: un intercept, puis 4 autres désignant différentes valeurs que peuvent prendre les niveaux. Ces niveaux croient-ils linéairement? De manière quadratique, cubique ou plus loin dans des distributions polynomiales?</p>
<div class="cell">
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modmat_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">statut</span>, <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">statut_o</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">statut</span>, names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"valeur"</span><span class="op">)</span></span>
<span><span class="va">modmat_tidy</span><span class="op">$</span><span class="va">statut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">modmat_tidy</span><span class="op">$</span><span class="va">statut</span>,</span>
<span>                             levels <span class="op">=</span> <span class="va">statut</span>,</span>
<span>                             ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">modmat_tidy</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">statut</span>, y <span class="op">=</span> <span class="va">valeur</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">variable</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-encoding-ordinal-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Règle générale, pour les variables ordinales, on préférera une distribution linéaire, et c’est l’option par défaut de la fonction <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. L’utilisation d’une autre distribution peut être effectuée à la mitaine en utilisant dans le modèle la colonne désirée de la sortie de la fonction <code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code>.</p>
</section><section id="régression-multiple-à-plusieurs-variables" class="level4" data-number="7.8.1.6"><h4 data-number="7.8.1.6" class="anchored" data-anchor-id="régression-multiple-à-plusieurs-variables">
<span class="header-section-number">7.8.1.6</span> Régression multiple à plusieurs variables</h4>
<p>Reprenons le tableau de données du rendement de maïs.</p>
<div class="cell">
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">lasrosas.corn</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  year       lat      long yield nitro topo     bv rep nf
1 1999 -33.05113 -63.84886 72.14 131.5    W 162.60  R1 N5
2 1999 -33.05115 -63.84879 73.79 131.5    W 170.49  R1 N5
3 1999 -33.05116 -63.84872 77.25 131.5    W 168.39  R1 N5
4 1999 -33.05117 -63.84865 76.35 131.5    W 176.68  R1 N5
5 1999 -33.05118 -63.84858 75.55 131.5    W 171.46  R1 N5
6 1999 -33.05120 -63.84851 70.24 131.5    W 170.56  R1 N5</code></pre>
</div>
</div>
<p>Pour ajouter des variables au modèle dans l’interface-formule, on additionne les noms de colonne. La variable <code>lat</code> désigne la latitude, la variable <code>long</code> désigne la longitude et la variable <code>bv</code> (<em>brightness value</em>) désigne la teneur en matière organique du sol (plus <code>bv</code> est élevée, plus faible est la teneur en matière organique).</p>
<div class="cell">
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modlin_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">lat</span> <span class="op">+</span> <span class="va">long</span> <span class="op">+</span> <span class="va">nitro</span> <span class="op">+</span> <span class="va">topo</span> <span class="op">+</span> <span class="va">bv</span>,</span>
<span>               data <span class="op">=</span> <span class="va">lasrosas.corn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modlin_5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ lat + long + nitro + topo + bv, data = lasrosas.corn)

Residuals:
    Min      1Q  Median      3Q     Max 
-48.405 -11.071  -1.251  10.592  40.078 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.946e+05  3.309e+04   5.882 4.45e-09 ***
lat          5.541e+03  4.555e+02  12.163  &lt; 2e-16 ***
long         1.776e+02  4.491e+02   0.395    0.693    
nitro        6.867e-02  5.451e-03  12.597  &lt; 2e-16 ***
topoHT      -2.665e+01  1.087e+00 -24.520  &lt; 2e-16 ***
topoLO       5.565e+00  1.035e+00   5.378 8.03e-08 ***
topoW       -1.465e+01  1.655e+00  -8.849  &lt; 2e-16 ***
bv          -5.089e-01  3.069e-02 -16.578  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.47 on 3435 degrees of freedom
Multiple R-squared:  0.5397,    Adjusted R-squared:  0.5387 
F-statistic: 575.3 on 7 and 3435 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>L’ampleur des coefficients est relatif à l’échelle de la variable. En effet, un coefficient de 5541 sur la variable <code>lat</code> n’est pas comparable au coefficient de la variable <code>bv</code>, de -0.5089, étant donné que les variables ne sont pas exprimées avec la même échelle. Pour les comparer sur une même base, on peut centrer (soustraire la moyenne) et réduire (diviser par l’écart-type).</p>
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lasrosas.corn_sc</span> <span class="op">&lt;-</span> <span class="va">lasrosas.corn</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lat"</span>, <span class="st">"long"</span>, <span class="st">"nitro"</span>, <span class="st">"bv"</span><span class="op">)</span>, <span class="va">scale</span><span class="op">)</span></span>
<span></span>
<span><span class="va">modlin_5_sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">lat</span> <span class="op">+</span> <span class="va">long</span> <span class="op">+</span> <span class="va">nitro</span> <span class="op">+</span> <span class="va">topo</span> <span class="op">+</span> <span class="va">bv</span>,</span>
<span>               data <span class="op">=</span> <span class="va">lasrosas.corn_sc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modlin_5_sc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ lat + long + nitro + topo + bv, data = lasrosas.corn_sc)

Residuals:
    Min      1Q  Median      3Q     Max 
-48.405 -11.071  -1.251  10.592  40.078 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  78.9114     0.6666 118.376  &lt; 2e-16 ***
lat           3.9201     0.3223  12.163  &lt; 2e-16 ***
long          0.3479     0.8796   0.395    0.693    
nitro         2.9252     0.2322  12.597  &lt; 2e-16 ***
topoHT      -26.6487     1.0868 -24.520  &lt; 2e-16 ***
topoLO        5.5647     1.0347   5.378 8.03e-08 ***
topoW       -14.6487     1.6555  -8.849  &lt; 2e-16 ***
bv           -4.9253     0.2971 -16.578  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.47 on 3435 degrees of freedom
Multiple R-squared:  0.5397,    Adjusted R-squared:  0.5387 
F-statistic: 575.3 on 7 and 3435 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Typiquement, les variables catégorielles, qui ne sont pas mises à l’échelle, donneront des coefficients plus élevées, et devrons être évaluées entre elles et non comparativement aux variables mises à l’échelle. Une manière conviviale de représenter des coefficients consiste à utiliser la fonction <code>tidy</code> du module <strong><code>broom</code></strong>, qui génère un tableau contenant les coefficients ainsi que leurs intervalles de confiance, que nous pourrons ensuite porter graphiquement.</p>
<div class="cell">
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://broom.tidymodels.org/">"broom"</a></span><span class="op">)</span> <span class="co"># ou bien charger le méta-module tidymodels</span></span>
<span><span class="va">intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">modlin_5_sc</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">intervals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  term        estimate std.error statistic   p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   78.9       0.667   118.    0            77.6      80.2 
2 lat            3.92      0.322    12.2   2.34e- 33     3.29      4.55
3 long           0.348     0.880     0.395 6.93e-  1    -1.38      2.07
4 nitro          2.93      0.232    12.6   1.33e- 35     2.47      3.38
5 topoHT       -26.6       1.09    -24.5   1.74e-122   -28.8     -24.5 
6 topoLO         5.56      1.03      5.38  8.03e-  8     3.54      7.59
7 topoW        -14.6       1.66     -8.85  1.39e- 18   -17.9     -11.4 
8 bv            -4.93      0.297   -16.6   1.92e- 59    -5.51     -4.34</code></pre>
</div>
</div>
<p>La valeur par défaut de l’argument <code>conf.level</code> est de 0.95, mais je vous suggère de toujours l’écrire de manière explicite, ne serait-ce que pour rappeler à vous-même ainsi qu’à vos collègues que cette valeur est arbitraire: il s’agit d’une décision d’analyse, non pas d’une valeur à utiliser par convention.</p>
<p>Pour le graphique, on aura avantage à séparer les effets catégoriels aux effets numériques pour mieux interpréter leurs effets entre eux. J’utilise la fonction <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">dplyr::case_when()</a></code> pour créer une nouvelle colonne qui catégorisera les termes de l’équation. Cette catégorie me permettra d’effectuer un <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">intervals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">term</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"topoHT"</span>, <span class="st">"topoLO"</span>, <span class="st">"topoW"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Catégorie"</span>, <span class="co"># condition ~ résultat</span></span>
<span>    <span class="va">term</span> <span class="op">==</span> <span class="st">"(Intercept)"</span> <span class="op">~</span> <span class="st">"Intercept"</span>,  <span class="co"># condition ~ résultat</span></span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"numérique"</span> <span class="co"># pour toute autre condition (TRUE) ~ résultat</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, y <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">conf.low</span>, xend <span class="op">=</span> <span class="va">conf.high</span>, yend <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Coefficient standardisé"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">type</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">1</span>, strip.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-multivariate-lm-ci-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On y voit qu’à l’exception de la variable <code>long</code>, tous les coefficients sont éloignés de 0. Le coefficient <code>bv</code> est négatif, indiquant que plus la valeur de <code>bv</code> est élevé (donc plus le sol est pauvre en matière organique), plus le rendement est faible. Plus la latitude est élevée (plus on se dirige vers le Nord de l’Argentine), plus le rendement est élevé. La dose d’azote a aussi un effet statistique positif sur le rendement.</p>
<p>Quant aux catégories topographiques, elles sont toutes éloignées de la catégorie <code>E</code>, placée à zéro. De plus, les intervalles de confiance à 0.95 ne se chevauchant pas, on peut conclure que la variabilité du phénomène échantillonné n’est pas suffisante pour expliquer les différences importantes entre elles.</p>
<p>On pourra retrouver des cas où l’effet combiné de plusieurs variables diffère de l’effet des deux variables prises séparément. Par exemple, on pourrait évaluer l’effet de l’azote et celui de la topographie dans un même modèle, puis y ajouter une interaction entre l’azote et la topographie, qui définira des effets supplémentaires de l’azote selon chaque catégorie topographique. C’est ce que l’on appelle une interaction.</p>
<p>Dans l’interface-formule, l’interaction entre l’azote et la topographie est notée <code>nitro:topo</code>. Pour ajouter cette interaction, la formule deviendra <code>yield ~ nitro + topo + nitro:topo</code>. Une approche équivalente est d’utiliser le raccourci <code>yield ~ nitro * topo</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modlin_5_sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">nitro</span> <span class="op">*</span> <span class="va">topo</span>,</span>
<span>               data <span class="op">=</span> <span class="va">lasrosas.corn_sc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modlin_5_sc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ nitro * topo, data = lasrosas.corn_sc)

Residuals:
    Min      1Q  Median      3Q     Max 
-47.984 -11.985  -1.388  10.339  40.636 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   78.6999     0.5322 147.870  &lt; 2e-16 ***
nitro          1.8131     0.5351   3.388 0.000711 ***
topoHT       -30.0052     0.7394 -40.578  &lt; 2e-16 ***
topoLO         6.2026     0.7190   8.627  &lt; 2e-16 ***
topoW        -11.9628     0.6939 -17.240  &lt; 2e-16 ***
nitro:topoHT   1.2553     0.7461   1.682 0.092565 .  
nitro:topoLO   0.5695     0.7186   0.792 0.428141    
nitro:topoW    0.7702     0.6944   1.109 0.267460    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.38 on 3435 degrees of freedom
Multiple R-squared:  0.4756,    Adjusted R-squared:  0.4746 
F-statistic: 445.1 on 7 and 3435 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Les résultats montrent des effets de l’azote et des catégories topographiques, mais il y a davantage d’incertitude sur les interactions, indiquant que l’effet statistique de l’azote est sensiblement le même indépendamment des niveaux topographiques.</p>
<p>Dans le cas des régressions multiples, les résidus ne peuvent pas être présentés selon une variable explicative <span class="math inline">\(x\)</span>, puisqu’il y en a plusieurs. On fera l’analyse des résidus selon la variable réponse <span class="math inline">\(y\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">lasrosas.corn_sc</span><span class="op">$</span><span class="va">yield</span>,</span>
<span>  residus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">modlin_5_sc</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, y <span class="op">=</span> <span class="va">residus</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"y"</span>, y <span class="op">=</span> <span class="st">"Résidus"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-residuals-mult-reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Dans ce modèle, il y a clairement une structure qui nous échappe! L’ajout d’autres variables nous permettrait éventuellement d’obtenir une distribution qui s’approche d’un bruit.</p>
</section><section id="les-interactions" class="level4" data-number="7.8.1.7"><h4 data-number="7.8.1.7" class="anchored" data-anchor-id="les-interactions">
<span class="header-section-number">7.8.1.7</span> Les interactions</h4>
<p>Une interaction est un effet supplémentaire qui est investigué pour des combinaisons de variables. L’interaction entre l’azote et la topographie est une nouvelle variable créée par la multiplication de l’azote, une variable numérique, et de la topographie, qui ici est une variable catégorielle.</p>
<div class="cell">
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">nitro</span> <span class="op">*</span> <span class="va">topo</span>, data <span class="op">=</span> <span class="va">lasrosas.corn_sc</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)    nitro topoHT topoLO topoW nitro:topoHT nitro:topoLO
1           1 1.571194      0      0     1            0            0
2           1 1.571194      0      0     1            0            0
3           1 1.571194      0      0     1            0            0
4           1 1.571194      0      0     1            0            0
5           1 1.571194      0      0     1            0            0
6           1 1.571194      0      0     1            0            0
  nitro:topoW
1    1.571194
2    1.571194
3    1.571194
4    1.571194
5    1.571194
6    1.571194</code></pre>
</div>
</div>
<p>L’entête de la matrice modèle montre que l’interaction est l’addition de trois variables, qui sont nulles si la catégorie topographique est absente, mais qui prend la dose d’azote pour la catégorie présente seulement.</p>
<p>L’interprétation d’une interaction est spécifique au modèle utilisé. Une manière de l’interpréter est de se demander dans quelles unités elle est exprimée. Dans notre exemple, il s’agit de kg/ha standardisés.</p>
<p>Prenons un autre exemple, cette fois-ci avec des données fictives. Une enquête a été menée où des personnes évaluaient le karma (échelle 0 à 10) de pieds nus, en bas (chaussettes) et/ou en sandales.</p>
<div class="cell">
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">karma_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/karma_df.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 600 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (4): ID, sandales, bas, karma

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Nous désirons savoir quelle est l’effet des bas et des sandales sur le karma, donc 💖 ~ 👡 + 🧦.</p>
<div class="cell">
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">karma</span> <span class="op">~</span> <span class="va">sandales</span> <span class="op">+</span> <span class="va">bas</span>, <span class="va">karma_df</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.67     0.147      25.0 1.11e-94
2 sandales        2.29     0.166      13.8 7.99e-38
3 bas             1.77     0.168      10.5 6.31e-24</code></pre>
</div>
</div>
<p>À partir du scénario à pieds nus d’un karma de 3.67, les sandales ajoutent 2.29 de points de karma, alors que les bas en ajoutent 1.8. Mais ce modèle est incomplet, cas on n’évalue pas l’effet des bas ET des sandales, donc 💖 ~ 👡 * 🧦.</p>
<div class="cell">
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">karma</span> <span class="op">~</span> <span class="va">sandales</span> <span class="op">*</span> <span class="va">bas</span>, <span class="va">karma_df</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term         estimate std.error statistic  p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)      2.68     0.134      20.0 2.22e-68
2 sandales         3.68     0.159      23.2 4.07e-85
3 bas              3.20     0.162      19.8 1.40e-67
4 sandales:bas    -5.25     0.309     -17.0 3.79e-53</code></pre>
</div>
</div>
<p>Le modèle est plus clair. Sans interaction, les effets sur le karma des bas et des sandales étaient négativement affectés par l’effet d’interaction <code>sandales:bas</code>, le karma étant poussé à la baisse par le <a href="https://youtu.be/_whvVXX0hCk?t=86">bas blanc dans vos sandales</a>.</p>
<p>Il est possible d’ajouter des interactions doubles, triples, quadruples, etc. Mais plus il y a d’interactions, plus votre modèle comprendra de variables et vos tests d’hypothèse perdront en puissance statistique.</p>
</section><section id="les-modèles-linéaires-généralisés" class="level4" data-number="7.8.1.8"><h4 data-number="7.8.1.8" class="anchored" data-anchor-id="les-modèles-linéaires-généralisés">
<span class="header-section-number">7.8.1.8</span> Les modèles linéaires généralisés</h4>
<p>Dans un modèle linéaire ordinaire, un changement constant dans les variables explicatives résulte en un changement constant de la variable-réponse. Cette supposition ne serait pas adéquate si la variable-réponse était un décompte, si elle est booléenne ou si, de manière générale, la variable-réponse ne suivait pas une distribution continue. De manière plus spécifique, elle ne s’applique pas aux cas où il n’y a pas moyen de retrouver une distribution normale des résidus. On pourra bien sûr transformer les variables. Mais il pourrait s’avérer impossible ou tout simplement non souhaitable de transformer les variables. Le modèle linéaire généralisé (MLG, ou <em>generalized linear model</em> - GLM) est une généralisation du modèle linéaire ordinaire chez qui la variable-réponse peut être caractérisé par une distribution de Poisson, de Bernouilli, etc.</p>
<p>Prenons d’abord le cas d’un décompte de vers fil-de-fer (<code>worms</code>) retrouvés dans des parcelles sous différents traitements (<code>trt</code>). Les décomptes sont typiquement distribués selon une loi de Poisson.</p>
<div class="cell">
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cochran.wireworms</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">worms</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-multivariate-glm-hist-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Explorons les décomptes selon les traitements.</p>
<div class="cell">
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cochran.wireworms</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">trt</span>, y <span class="op">=</span> <span class="va">worms</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-multivariate-glm-boxplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Les traitements semblent à première vue avoir un effet comparativement au contrôle. Lançons un MLG avec la fonction <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>, et spécifions que la sortie est une distribution de Poisson. Bien que la fonction de lien (<code>link = "log"</code>) soit explictement imposée, le log est la valeur par défaut pour les distributions de Poisson. Ainsi, les coefficients du modèles devront être interprétés selon un modèle <span class="math inline">\(log \left(worms \right) = intercept + pente \times coefficient\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modglm_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">worms</span> <span class="op">~</span> <span class="va">trt</span>, <span class="va">cochran.wireworms</span>, family <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modglm_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = worms ~ trt, family = stats::poisson(link = "log"), 
    data = cochran.wireworms)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.1823     0.4082   0.447 0.655160    
trtM          1.6422     0.4460   3.682 0.000231 ***
trtN          1.7636     0.4418   3.991 6.57e-05 ***
trtO          1.5755     0.4485   3.513 0.000443 ***
trtP          1.3437     0.4584   2.931 0.003375 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 64.555  on 24  degrees of freedom
Residual deviance: 38.026  on 20  degrees of freedom
AIC: 125.64

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>L’interprétation spécifique des coefficients d’une régression de Poisson doit passer par la fonction de lien <span class="math inline">\(log \left(worms \right) = intercept + pente \times coefficient\)</span>. Le traitement de référence (K), qui correspond à l’intercept, sera accompagné d’un nombre de vers de <span class="math inline">\(exp \left(0.1823\right) = 1.20\)</span> vers, et le traitement M, à <span class="math inline">\(exp \left(1.6422\right) = 5.17\)</span> vers. Cela correspond à ce que l’on observe sur les boxplots plus haut.</p>
<p>Il est très probable (p-value de ~0.66) qu’un intercept (traitement K) de 0.18 ayant une erreur standard de 0.4082 ait été généré depuis une population dont l’intercept est nul. Quant aux autres traitements, leurs effets sont tous significatifs au seuil 0.05, mais peuvent-ils être considérés comme équivalents?</p>
<div class="cell">
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">modglm_1</span><span class="op">)</span>, <span class="co"># [-1] enlever l'intercept</span></span>
<span>                    LL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">modglm_1</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="co"># [-1, ] enlever la première ligne, celle de l'intercept</span></span>
<span>                    UL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">modglm_1</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>                    variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">modglm_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...
Waiting for profiling to be done...</code></pre>
</div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">intervals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  Estimate     LL    UL variable   
     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      
1    0.182 -0.740 0.888 (Intercept)
2    1.64   0.840 2.62  trtM       
3    1.76   0.972 2.74  trtN       
4    1.58   0.766 2.56  trtO       
5    1.34   0.509 2.34  trtP       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">intervals</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Estimate</span>, y <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">LL</span>, xend <span class="op">=</span> <span class="va">UL</span>,</span>
<span>                               y <span class="op">=</span> <span class="va">variable</span>, yend <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Coefficient"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-multivariate-glm-plot-effects-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Les intervalles de confiance se superposant, on ne peut pas conclure qu’un traitement est lié à une réduction plus importante de vers qu’un autre, au seuil 0.05.</p>
<p>Maintenant, à défaut de trouver un tableau de données plus approprié, prenons le tableau <code>mtcars</code>, qui rassemble des données sur des modèles de voitures. La colonne <code>vs</code>, pour v-shaped, inscrit 0 si les pistons sont droits et 1 s’ils sont placés en V dans le moteur. Peut-on expliquer la forme des pistons selon le poids du véhicule (<code>wt</code>)?</p>
<div class="cell">
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Fiat 128          32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Volvo 142E        21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
Hornet 4 Drive    21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Chrysler Imperial 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
Datsun 710        22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Merc 450SL        17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wt</span>, y <span class="op">=</span> <span class="va">vs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-multivariate-glm-cars-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Il semble y avoir une tendance: les véhicules plus lourds ont plutôt des pistons droits (<code>vs = 0</code>). Vérifions cela.</p>
<div class="cell">
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modglm_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">vs</span> <span class="op">~</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span>, family <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modglm_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = vs ~ wt, family = stats::binomial(), data = mtcars)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)   5.7147     2.3014   2.483  0.01302 * 
wt           -1.9105     0.7279  -2.625  0.00867 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 43.860  on 31  degrees of freedom
Residual deviance: 31.367  on 30  degrees of freedom
AIC: 35.367

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p><strong>Exercice</strong>. Analyser les résultats.</p>
</section><section id="les-modèles-non-linéaires" class="level4" data-number="7.8.1.9"><h4 data-number="7.8.1.9" class="anchored" data-anchor-id="les-modèles-non-linéaires">
<span class="header-section-number">7.8.1.9</span> Les modèles non-linéaires</h4>
<p>La hauteur d’un arbre en fonction du temps n’est typiquement pas linéaire. Elle tend à croître de plus en plus lentement jusqu’à un plateau. De même, le rendement d’une culture traitée avec des doses croissantes de fertilisants tend à atteindre un maximum, puis à se stabiliser.</p>
<p>Ces phénomènes ne peuvent pas être approximés par des modèles linéaires. Examinons les données du tableau <code>engelstad.nitro</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">engelstad.nitro</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         loc year nitro yield
1  Knoxville 1966     0  63.0
2  Knoxville 1965   335  61.2
3    Jackson 1965   335  73.0
4    Jackson 1966   201  61.3
5    Jackson 1966   335  59.8
6  Knoxville 1964     0  60.9
7  Knoxville 1964    67  75.9
8    Jackson 1966    67  45.2
9    Jackson 1962   201  73.1
10   Jackson 1964   335  67.8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">engelstad.nitro</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nitro</span>, y <span class="op">=</span> <span class="va">yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">year</span> <span class="op">~</span> <span class="va">loc</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-multivariate-nls-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Le modèle de Mitscherlich pourrait être utilisé.</p>
<p><span class="math display">\[ y = A \left( 1 - e^{-R \left( E + x \right)} \right) \]</span></p>
<p>où <span class="math inline">\(y\)</span> est le rendement, <span class="math inline">\(x\)</span> est la dose, <span class="math inline">\(A\)</span> est l’asymptote vers laquelle la courbe converge à dose croissante, <span class="math inline">\(E\)</span> est l’équivalent de dose fourni par l’environnement et <span class="math inline">\(R\)</span> est le taux de réponse.</p>
<p>Explorons la fonction.</p>
<div class="cell">
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mitscherlich_f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">A</span>, <span class="va">E</span>, <span class="va">R</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">A</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">R</span><span class="op">*</span><span class="op">(</span><span class="va">E</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">350</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">mitscherlich_f</span><span class="op">(</span><span class="va">x</span>, A <span class="op">=</span> <span class="fl">75</span>, E <span class="op">=</span> <span class="fl">30</span>, R <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">engelstad.nitro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nitro</span>, y <span class="op">=</span> <span class="va">yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/biostats-multivariate-nls-miscth-explore-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Exercice</strong>. Changez les paramètres pour visualiser comment la courbe réagit.</p>
<p>Nous pouvons décrire le modèle grâce à l’interface formule dans la fonction <code><a href="https://rdrr.io/r/stats/nls.html">nls()</a></code>. Notez que les modèles non-linéaires demandent des stratégies de calcul différentes de celles des modèles linéaires. En tout temps, nous devons identifier des valeurs de départ raisonnables pour les paramètres dans l’argument <code>start</code>. Vous réussirez rarement à obtenir une convergence du premier coup avec vos paramètres de départ. Le défi est d’en trouver qui permettront au modèle de converger. Parfois, le modèle ne convergera jamais. D’autres fois, il convergera vers des solutions différentes selon les variables de départ choisies.</p>
<pre><code>modnl_1 &lt;- nls(yield ~ A * (1 - exp(-R*(E + nitro))),
                data = engelstad.nitro,
                start = list(A = 50, E = 10, R = 0.2))</code></pre>
<p>Le modèle ne converge pas (le bloc de calcul est désactivé). Essayons les valeurs prises plus haut, lors de la création du graphique, qui semblent bien s’ajuster.</p>
<div class="cell">
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modnl_1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">A</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">R</span><span class="op">*</span><span class="op">(</span><span class="va">E</span> <span class="op">+</span> <span class="va">nitro</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">engelstad.nitro</span>,</span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">75</span>, E <span class="op">=</span> <span class="fl">30</span>, R <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Bingo! Voyons maintenant le sommaire.</p>
<div class="cell">
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modnl_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: yield ~ A * (1 - exp(-R * (E + nitro)))

Parameters:
   Estimate Std. Error t value Pr(&gt;|t|)    
A 75.023427   3.331860  22.517   &lt;2e-16 ***
E 66.164111  27.251589   2.428   0.0184 *  
R  0.012565   0.004881   2.574   0.0127 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.34 on 57 degrees of freedom

Number of iterations to convergence: 5 
Achieved convergence tolerance: 8.066e-06</code></pre>
</div>
</div>
<p>Les paramètres sont différents de zéro, et donnent la courbe suivante.</p>
<div class="cell">
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">350</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">mitscherlich_f</span><span class="op">(</span><span class="va">x</span>,</span>
<span>                    A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">modnl_1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                    E <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">modnl_1</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                    R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">modnl_1</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">engelstad.nitro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nitro</span>, y <span class="op">=</span> <span class="va">yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-multivariate-nls-resultat-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Et les résidus…</p>
<div class="cell">
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">modnl_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">res</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-multivariate-nls-residuals-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>nitro <span class="op">=</span> <span class="va">engelstad.nitro</span><span class="op">$</span><span class="va">nitro</span>, res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">modnl_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nitro</span>, y <span class="op">=</span> <span class="va">res</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-multivariate-nls-residuals2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Les résidus ne sont pas distribués normalement, mais semblent bien partagés de part et d’autre de la courbe.</p>
</section></section><section id="modèles-à-effets-mixtes" class="level3" data-number="7.8.2"><h3 data-number="7.8.2" class="anchored" data-anchor-id="modèles-à-effets-mixtes">
<span class="header-section-number">7.8.2</span> Modèles à effets mixtes</h3>
<p>Lorsque l’on combine des variables fixes (testées lors de l’expérience) et des variables aléatoire (variation des unités expérimentales), on obtient un modèle mixte. Les modèles mixtes peuvent être univariés, multivariés, linéaires (ordinaires ou généralisés) ou non linéaires.</p>
<p>À la différence d’un effet fixe, un effet aléatoire sera toujours distribué normalement avec une moyenne de 0 et une certaine variance. Dans un modèle linéaire où l’effet aléatoire est un décalage d’intercept, cet effet s’additionne aux effets fixes:</p>
<p><span class="math display">\[ y = X \beta + Z b + \epsilon \]</span></p>
<p>où:</p>
<p><span class="math inline">\(Z\)</span> est la matrice du modèle à <span class="math inline">\(n\)</span> observations et <span class="math inline">\(p\)</span> variables aléatoires. Les variables aléatoires sont souvent des variables nominales qui subissent un encodage catégoriel.</p>
<p><span class="math display">\[ Z = \left( \begin{matrix}
z_{11} &amp; \cdots &amp; z_{1p}  \\
z_{21} &amp; \cdots &amp; z_{2p}  \\
\vdots &amp; \ddots &amp; \vdots  \\
z_{n1} &amp; \cdots &amp; z_{np}
\end{matrix} \right) \]</span></p>
<p><span class="math inline">\(b\)</span> est la matrice des <span class="math inline">\(p\)</span> coefficients aléatoires.</p>
<p><span class="math display">\[ b = \left( \begin{matrix}
b_0  \\
b_1  \\
\vdots \\
b_p
\end{matrix} \right) \]</span></p>
<p>Le tableau <code>lasrosas.corn</code>, utilisé précédemment, contenait trois répétitions effectuées au cours de deux années, 1999 et 2001. Étant donné que la répétition R1 de 1999 n’a rien à voir avec la répétition R1 de 2001, on dit qu’elle est <strong>emboîtée</strong> dans l’année.</p>
<p>Le module <code>nlme</code> nous aidera à monter notre modèle mixte.</p>
<div class="cell">
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">"nlme"</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mmodlin_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="va">yield</span> <span class="op">~</span> <span class="va">lat</span> <span class="op">+</span> <span class="va">long</span> <span class="op">+</span> <span class="va">nitro</span> <span class="op">+</span> <span class="va">topo</span> <span class="op">+</span> <span class="va">bv</span>,</span>
<span>                 random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">|</span><span class="va">year</span><span class="op">/</span><span class="va">rep</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">lasrosas.corn</span>,</span>
<span>                 control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lmeControl.html">lmeControl</a></span><span class="op">(</span>opt <span class="op">=</span> <span class="st">"optim"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>À ce stade vous devriez commencer à être familier avec l’interface formule et vous devriez saisir l’argument <code>fixed</code>, qui désigne l’effet fixe. L’effet aléatoire est <code>random</code>, suit un tilde <code>~</code>. À gauche de la barre verticale <code>|</code>, on place les variables désignant les effets aléatoire sur la pente. Nous n’avons pas couvert cet aspect, alors nous le laissons à <code>1</code>. À droite, on retrouve un structure d’emboîtement désignant l’effet aléatoire: le premier niveau est l’année, dans laquelle est emboîtée la répétition.</p>
<div class="cell">
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mmodlin_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: lasrosas.corn 
       AIC      BIC    logLik
  26535.37 26602.93 -13256.69

Random effects:
 Formula: ~1 | year
        (Intercept)
StdDev:    20.35438

 Formula: ~1 | rep %in% year
        (Intercept) Residual
StdDev:    11.17449 11.35617

Fixed effects:  yield ~ lat + long + nitro + topo + bv 
                 Value Std.Error   DF    t-value p-value
(Intercept) -1379437.0  55894.55 3430 -24.679273   0.000
lat           -25453.0   1016.53 3430 -25.039085   0.000
long           -8432.3    466.05 3430 -18.092989   0.000
nitro              0.0      0.00 3430   1.739757   0.082
topoHT           -27.7      0.92 3430 -30.122438   0.000
topoLO             6.8      0.88 3430   7.804733   0.000
topoW            -16.7      1.40 3430 -11.944793   0.000
bv                -0.5      0.03 3430 -19.242424   0.000
 Correlation: 
       (Intr) lat    long   nitro  topoHT topoLO topoW 
lat     0.897                                          
long    0.866  0.555                                   
nitro   0.366  0.391  0.247                            
topoHT  0.300 -0.017  0.582  0.024                     
topoLO -0.334 -0.006 -0.621 -0.038 -0.358              
topoW   0.403 -0.004  0.762  0.027  0.802 -0.545       
bv     -0.121 -0.012 -0.214 -0.023 -0.467  0.346 -0.266

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-4.32360269 -0.66781576 -0.07450854  0.61587533  3.96434003 

Number of Observations: 3443
Number of Groups: 
         year rep %in% year 
            2             6 </code></pre>
</div>
</div>
<p>La sortie est semblable à celle de la fonction <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p>
<section id="modèles-mixtes-non-linéaires" class="level4" data-number="7.8.2.1"><h4 data-number="7.8.2.1" class="anchored" data-anchor-id="modèles-mixtes-non-linéaires">
<span class="header-section-number">7.8.2.1</span> Modèles mixtes non-linéaires</h4>
<p>Le modèle non linéaire créé plus haut liait le rendement à la dose d’azote. Toutefois, les unités expérimentales (le site <code>loc</code> et l’année <code>year</code>) n’étaient pas pris en considération. Nous allons maintenant les considérer.</p>
<p>Nous devons décider la structure de l’effet aléatoire, et sur quelles variables il doit être appliqué - la décision appartient à l’analyste. Il me semble plus convenable de supposer que le site et l’année affectera le rendement maximum plutôt que l’environnement et le taux: les effets aléatoires seront donc affectés à la variable <code>A</code>. Les effets aléatoires n’ont pas de structure d’emboîtement. L’effet de l’année sur A sera celui d’une pente et l’effet de site sera celui de l’intercept. La fonction que nous utiliserons est <code><a href="https://rdrr.io/pkg/nlme/man/nlme.html">nlme()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/nlme.html">nlme</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">A</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">R</span><span class="op">*</span><span class="op">(</span><span class="va">E</span> <span class="op">+</span> <span class="va">nitro</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           data <span class="op">=</span> <span class="va">engelstad.nitro</span>,</span>
<span>           start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">75</span>, E <span class="op">=</span> <span class="fl">30</span>, R <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>           fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">A</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">E</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">R</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>           random <span class="op">=</span> <span class="va">A</span> <span class="op">~</span> <span class="va">year</span> <span class="op">|</span> <span class="va">loc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nonlinear mixed-effects model fit by maximum likelihood
  Model: yield ~ A * (1 - exp(-R * (E + nitro))) 
  Data: engelstad.nitro 
       AIC      BIC    logLik
  477.2285 491.8889 -231.6143

Random effects:
 Formula: A ~ year | loc
 Structure: General positive-definite, Log-Cholesky parametrization
              StdDev       Corr  
A.(Intercept)  2.571625268 A.(In)
A.year         0.003062626 -0.556
Residual      11.152760017       

Fixed effects:  list(A ~ 1, E ~ 1, R ~ 1) 
                 Value Std.Error DF   t-value p-value
A.(Intercept) 74.58281  4.722807 56 15.792054  0.0000
E             65.57006 25.534748 56  2.567876  0.0129
R              0.01308  0.004807 56  2.720245  0.0087
 Correlation: 
  A.(In) E     
E  0.379       
R -0.483 -0.934

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-1.83376868 -0.89290221  0.07419032  0.68354473  1.82431443 

Number of Observations: 60
Number of Groups: 2 </code></pre>
</div>
</div>
<p>Et sur graphique:</p>
<div class="cell">
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">engelstad.nitro</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nitro</span>, y <span class="op">=</span> <span class="va">yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">year</span> <span class="op">~</span> <span class="va">loc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>nitro <span class="op">=</span> <span class="va">engelstad.nitro</span><span class="op">$</span><span class="va">nitro</span>,</span>
<span>                          yield <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mm</span>, level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"grey35"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">95</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07a-biostats_files/figure-html/bios-multivariate-nlme-nl-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Les modèles mixtes non linéaires peuvent devenir très complexes lorsque les paramètres, par exemple A, E et R, sont eux-même affectés linéairement par des variables (par exemple <code>A ~ topo</code>). Pour aller plus loin, consultez <a href="https://doi.org/10.3389/fenvs.2017.00081">Parent et al.&nbsp;(2017)</a> ainsi que les <a href="https://github.com/essicolo/site-specific-multilevel-modeling-of-potato-response-to-nitrogen-fertilization">calculs associés à l’article</a>. Ou écrivez-moi un courriel pour en discuter!</p>
<p><strong>Note</strong>. L’interprétation de <em>p-values</em> sur les modèles mixtes est controversée. À ce sujet, Douglas Bates a écrit une longue lettre à la communauté de développement du module <code>lme4</code>, une alternative à <code>nlme</code>, qui remet en cause l’utilisation des p-values, <a href="https://stat.ethz.ch/pipermail/r-help/2006-May/094765.html">ici</a>. De plus en plus, pour les modèles mixtes, on se tourne vers les statistiques bayésiennes, couvertes dans le <a href="07b-bayes.html">chapitre&nbsp;<span>8</span></a> avec le module greta. Mais en ce qui a trait aux modèles mixtes, le module <a href="https://github.com/paul-buerkner/brms"><code>brms</code></a> automatise bien des aspects de l’approche bayésienne.</p>
</section></section><section id="aller-plus-loin" class="level3" data-number="7.8.3"><h3 data-number="7.8.3" class="anchored" data-anchor-id="aller-plus-loin">
<span class="header-section-number">7.8.3</span> Aller plus loin</h3>
<section id="statistiques-générales" class="level4" data-number="7.8.3.1"><h4 data-number="7.8.3.1" class="anchored" data-anchor-id="statistiques-générales">
<span class="header-section-number">7.8.3.1</span> Statistiques générales:</h4>
<ul>
<li><a href="https://ulaval.on.worldcat.org/oclc/1178980667">The analysis of biological data</a></li>
</ul></section><section id="statistiques-avec-r" class="level4" data-number="7.8.3.2"><h4 data-number="7.8.3.2" class="anchored" data-anchor-id="statistiques-avec-r">
<span class="header-section-number">7.8.3.2</span> Statistiques avec R</h4>
<ul>
<li>Disponibles en version électronique à la bibliothèque de l’Université Laval:
<ul>
<li>Introduction aux statistiques avec R: <a href="https://ulaval.on.worldcat.org/oclc/759004956">Introductory statistics with R</a>
</li>
<li>Approfondir les statistiques avec R: <a href="https://ulaval.on.worldcat.org/oclc/1323328970">The R Book, Third edition</a>
</li>
<li>Approfondir les modèles à effets mixtes avec R: <a href="https://ulaval.on.worldcat.org/oclc/690380460">Mixed Effects Models and Extensions in Ecology with R</a>
</li>
</ul>
</li>
<li>
<a href="https://moderndive.com/index.html">ModernDive</a>, un livre en ligne offrant une approche moderne avec le package <code>moderndive</code>.</li>
</ul>


</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./06-python.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction à Python</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./07b-bayes.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction à l’analyse bayésienne en écologie</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Analyse et modélisation d’agroécosystèmes est construit avec <a href="https://quarto.org/">Quarto</a>.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Lien vers le <a href="https://essicolo.github.io/ecologie-mathematique-R/">manuel original</a>.</div>
  </div>
</footer>


</body></html>